{
  "lote": 2,
  "status": "pending",
  "file_path": "src/app/components/WelcomePage.tsx",
  "created_at": "2026-02-27T05:36:16.595Z",
  "file_content": "/**\n * WelcomePage — Experiencia epica de entrada\n * \n * Nome grande na tela + badge \"Nucleo Inicial\" + animacao emocional\n * Pergunta obrigatoria: \"O que te atravessa que ninguem entende?\"\n * Ritual de entrada simbólico.\n */\n\nimport { useState } from \"react\";\nimport { motion, AnimatePresence } from \"motion/react\";\nimport { PenTool, User, MessageCircle, Sparkles, Star, Shield, ArrowRight, Check } from \"lucide-react\";\nimport { LogoIcon } from \"./LogoIcon\";\nimport { BadgeDisplay } from \"./BadgeDisplay\";\nimport { useProfileContext } from \"../../lib\";\nimport { useRitualLogs } from \"../../lib/useRitualLogs\";\nimport { supabase } from \"../../lib/supabase\";\n\ninterface WelcomePageProps {\n  onCreatePost: () => void;\n  onCompleteProfile: () => void;\n  onContactFounder: () => void;\n}\n\nexport function WelcomePage({ onCreatePost, onCompleteProfile, onContactFounder }: WelcomePageProps) {\n  const { user, refreshProfile } = useProfileContext();\n  const { completeRitual } = useRitualLogs(user?.id);\n  const [phase, setPhase] = useState<\"welcome\" | \"ritual\" | \"ready\">(\"welcome\");\n  const [ritualAnswer, setRitualAnswer] = useState(\"\");\n  const [saving, setSaving] = useState(false);\n  const [skipAttempt, setSkipAttempt] = useState(0);\n\n  const displayName = user?.display_name || user?.name || \"Membro\";\n  const firstLetter = displayName.charAt(0).toUpperCase();\n\n  // Simular badge \"Nucleo Inicial\" para novos membros\n  const welcomeBadges = [\n    {\n      id: \"welcome-badge\",\n      user_id: user?.id || \"\",\n      badge_type: \"nucleo_inicial\" as const,\n      earned_at: new Date().toISOString(),\n      is_active: true,\n    },\n  ];\n\n  const handleSaveRitual = async () => {\n    if (!ritualAnswer.trim() || !user) return;\n    setSaving(true);\n\n    try {\n      // Salvar a resposta do ritual no campo what_crosses_me\n      await supabase\n        .from(\"users\")\n        .update({ what_crosses_me: ritualAnswer.trim() })\n        .eq(\"id\", user.id);\n\n      // Registrar no ritual_logs como ritual de entrada\n      await completeRitual(\"entry\", ritualAnswer.trim());\n\n      await refreshProfile?.();\n      setPhase(\"ready\");\n    } catch (err) {\n      console.error(\"[WelcomePage] Erro ao salvar ritual:\", err);\n      setPhase(\"ready\"); // Prosseguir mesmo com erro\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-black flex items-center justify-center px-6 py-12 overflow-hidden\">\n      {/* Efeito de particulas sutis no fundo */}\n      <div className=\"fixed inset-0 pointer-events-none overflow-hidden\">\n        {[...Array(6)].map((_, i) => (\n          <motion.div\n            key={i}\n            className=\"absolute w-1 h-1 rounded-full bg-[#81D8D0]/20\"\n            animate={{\n              x: [Math.random() * 400, Math.random() * 400 - 200],\n              y: [Math.random() * 400, Math.random() * 400 - 200],\n              opacity: [0, 0.6, 0],\n            }}\n            transition={{\n              duration: 8 + Math.random() * 4,\n              repeat: Infinity,\n              delay: i * 1.5,\n            }}\n            style={{\n              left: `${20 + Math.random() * 60}%`,\n              top: `${20 + Math.random() * 60}%`,\n            }}\n          />\n        ))}\n      </div>\n\n      <AnimatePresence mode=\"wait\">\n        {/* ═══ FASE 1: BEM-VINDO ═══ */}\n        {phase === \"welcome\" && (\n          <motion.div\n            key=\"welcome\"\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0, y: -30 }}\n            transition={{ duration: 0.6 }}\n            className=\"w-full max-w-[700px] space-y-10 relative z-10\"\n          >\n            {/* Logo */}\n            <div className=\"text-center space-y-6\">\n              <motion.div\n                initial={{ opacity: 0, scale: 0.5 }}\n                animate={{ opacity: 1, scale: 1 }}\n                transition={{ duration: 0.8, type: \"spring\", stiffness: 150 }}\n              >\n                <LogoIcon size={80} className=\"h-[80px] w-[80px] mx-auto mb-6\" />\n              </motion.div>\n\n              {/* Nome GRANDE */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ duration: 0.6, delay: 0.4 }}\n              >\n                <p className=\"text-sm text-white/30 uppercase tracking-[0.3em] mb-3 font-semibold\">\n                  Bem-vindo(a) ao territorio\n                </p>\n                <h1 className=\"text-5xl md:text-7xl font-bold text-white leading-tight\">\n                  {displayName}\n                </h1>\n              </motion.div>\n\n              {/* Linha de separacao animada */}\n              <motion.div\n                initial={{ width: 0 }}\n                animate={{ width: \"120px\" }}\n                transition={{ duration: 0.8, delay: 0.8 }}\n                className=\"h-0.5 bg-gradient-to-r from-transparent via-[#81D8D0] to-transparent mx-auto\"\n              />\n\n              {/* Subtitulo */}\n              <motion.p\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                transition={{ duration: 0.5, delay: 1.0 }}\n                className=\"text-xl md:text-2xl text-[#81D8D0] font-medium\"\n              >\n                Voce esta dentro.\n              </motion.p>\n\n              {/* Badge Nucleo Inicial */}\n              <motion.div\n                initial={{ opacity: 0, scale: 0.8 }}\n                animate={{ opacity: 1, scale: 1 }}\n                transition={{ duration: 0.5, delay: 1.3, type: \"spring\" }}\n                className=\"flex justify-center\"\n              >\n                <div className=\"inline-flex items-center gap-2 px-5 py-2.5 bg-[#FFD700]/10 border border-[#FFD700]/30 rounded-full\">\n                  <Star className=\"h-4 w-4 text-[#FFD700]\" />\n                  <span className=\"text-sm text-[#FFD700] font-bold\">Nucleo Inicial</span>\n                  <Star className=\"h-4 w-4 text-[#FFD700]\" />\n                </div>\n              </motion.div>\n\n              <motion.p\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                transition={{ duration: 0.5, delay: 1.6 }}\n                className=\"text-white/40 text-sm max-w-md mx-auto leading-relaxed\"\n              >\n                Voce faz parte do nucleo inicial. Isso significa que este territorio\n                tambem e seu — construido por quem participa, moldado por quem se arrisca.\n              </motion.p>\n            </div>\n\n            {/* Botao para iniciar ritual */}\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ duration: 0.5, delay: 2.0 }}\n              className=\"text-center\"\n            >\n              <motion.button\n                onClick={() => setPhase(\"ritual\")}\n                whileHover={{ scale: 1.03, y: -2 }}\n                whileTap={{ scale: 0.97 }}\n                className=\"inline-flex items-center gap-3 px-8 py-4 bg-gradient-to-r from-[#C8102E] to-[#C8102E]/80 text-white rounded-2xl font-bold text-lg shadow-xl shadow-[#C8102E]/20 hover:shadow-2xl hover:shadow-[#C8102E]/30 transition-all\"\n              >\n                <Sparkles className=\"h-5 w-5\" />\n                Iniciar Ritual de Entrada\n                <ArrowRight className=\"h-5 w-5\" />\n              </motion.button>\n\n              {/* Pergunta obrigatoria — encorajamento emocional antes de permitir pular */}\n              {skipAttempt === 0 ? (\n                <motion.button\n                  onClick={() => setSkipAttempt(1)}\n                  initial={{ opacity: 0 }}\n                  animate={{ opacity: 1 }}\n                  transition={{ delay: 5.0 }}\n                  className=\"block mx-auto mt-6 text-[10px] text-white/10 hover:text-white/20 transition-colors\"\n                >\n                  Preciso de um momento...\n                </motion.button>\n              ) : (\n                <motion.div\n                  initial={{ opacity: 0, y: 5 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  className=\"mt-4 text-center space-y-2\"\n                >\n                  <p className=\"text-[11px] text-white/25 leading-relaxed\">\n                    O ritual e parte do que torna este espaco diferente.<br />\n                    Mas voce pode voltar depois — sem pressao.\n                  </p>\n                  <button\n                    onClick={() => setPhase(\"ready\")}\n                    className=\"text-[10px] text-white/15 hover:text-white/30 transition-colors underline underline-offset-2\"\n                  >\n                    Entrar sem ritual por enquanto\n                  </button>\n                </motion.div>\n              )}\n            </motion.div>\n          </motion.div>\n        )}\n\n        {/* ═══ FASE 2: RITUAL DE ENTRADA ═══ */}\n        {phase === \"ritual\" && (\n          <motion.div\n            key=\"ritual\"\n            initial={{ opacity: 0, y: 30 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -30 }}\n            transition={{ duration: 0.6 }}\n            className=\"w-full max-w-[600px] space-y-8 relative z-10\"\n          >\n            <div className=\"text-center space-y-4\">\n              <motion.div\n                initial={{ opacity: 0, scale: 0.5 }}\n                animate={{ opacity: 1, scale: 1 }}\n                transition={{ type: \"spring\", stiffness: 200, delay: 0.2 }}\n                className=\"w-16 h-16 rounded-2xl bg-[#C8102E]/15 border border-[#C8102E]/30 flex items-center justify-center mx-auto\"\n              >\n                <Shield className=\"h-8 w-8 text-[#C8102E]\" />\n              </motion.div>\n\n              <h2 className=\"text-2xl md:text-3xl text-white font-bold\">\n                Ritual de Entrada\n              </h2>\n\n              <p className=\"text-white/40 text-sm max-w-md mx-auto leading-relaxed\">\n                Uma unica pergunta. Sem resposta certa. Apenas honestidade.\n                Isso fica no seu perfil como marca de presenca.\n              </p>\n            </div>\n\n            {/* A pergunta */}\n            <motion.div\n              initial={{ opacity: 0, y: 15 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.5 }}\n              className=\"bg-white/5 border border-white/10 rounded-2xl p-6\"\n            >\n              <p className=\"text-lg md:text-xl text-white font-semibold mb-5 leading-relaxed text-center\">\n                &ldquo;O que te atravessa que ninguem entende?&rdquo;\n              </p>\n\n              <textarea\n                value={ritualAnswer}\n                onChange={(e) => setRitualAnswer(e.target.value)}\n                rows={4}\n                maxLength={500}\n                className=\"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white text-sm placeholder:text-white/20 focus:border-[#81D8D0]/50 focus:outline-none resize-none\"\n                placeholder=\"Escreva com honestidade. Nao precisa ser bonito.\"\n              />\n\n              <div className=\"flex items-center justify-between mt-3\">\n                <span className=\"text-[10px] text-white/20\">\n                  {ritualAnswer.length}/500\n                </span>\n                <div className=\"flex items-center gap-2\">\n                  {/* Pergunta obrigatoria — sem botao direto de pular */}\n                  {!ritualAnswer.trim() && (\n                    <span className=\"text-[10px] text-[#C8102E]/40 italic\">\n                      Resposta obrigatoria\n                    </span>\n                  )}\n                  <motion.button\n                    onClick={handleSaveRitual}\n                    disabled={!ritualAnswer.trim() || saving}\n                    whileHover={{ scale: 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                    className=\"flex items-center gap-2 px-5 py-2.5 bg-[#81D8D0] text-black rounded-xl text-sm font-bold disabled:opacity-40 disabled:cursor-not-allowed transition-all\"\n                  >\n                    {saving ? (\n                      <div className=\"w-4 h-4 border-2 border-black border-t-transparent rounded-full animate-spin\" />\n                    ) : (\n                      <Check className=\"h-4 w-4\" />\n                    )}\n                    {saving ? \"Salvando...\" : \"Marcar minha presenca\"}\n                  </motion.button>\n                </div>\n              </div>\n            </motion.div>\n          </motion.div>\n        )}\n\n        {/* ═══ FASE 3: PRONTO ═══ */}\n        {phase === \"ready\" && (\n          <motion.div\n            key=\"ready\"\n            initial={{ opacity: 0, y: 30 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.6 }}\n            className=\"w-full max-w-[700px] space-y-10 relative z-10\"\n          >\n            <div className=\"text-center space-y-5\">\n              <motion.div\n                initial={{ opacity: 0, scale: 0.8 }}\n                animate={{ opacity: 1, scale: 1 }}\n                transition={{ type: \"spring\", stiffness: 200 }}\n              >\n                <div className=\"w-20 h-20 rounded-3xl bg-gradient-to-br from-[#81D8D0]/20 to-[#C8102E]/20 border border-white/10 flex items-center justify-center mx-auto mb-4\">\n                  <span className=\"text-4xl text-white font-bold\">{firstLetter}</span>\n                </div>\n              </motion.div>\n\n              <motion.h2\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                transition={{ delay: 0.3 }}\n                className=\"text-3xl md:text-4xl text-white font-bold\"\n              >\n                {displayName}, voce esta pronto(a).\n              </motion.h2>\n\n              {/* Badges conquistadas na entrada */}\n              <motion.div\n                initial={{ opacity: 0, scale: 0.9 }}\n                animate={{ opacity: 1, scale: 1 }}\n                transition={{ delay: 0.4, type: \"spring\" }}\n                className=\"flex justify-center\"\n              >\n                <BadgeDisplay badges={welcomeBadges} />\n              </motion.div>\n\n              {/* Missao inicial */}\n              <motion.div\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.5 }}\n                className=\"inline-flex items-center gap-2 px-4 py-2 bg-[#C8102E]/10 border border-[#C8102E]/30 rounded-full\"\n              >\n                <Sparkles className=\"h-4 w-4 text-[#C8102E]\" />\n                <span className=\"text-sm text-[#C8102E] font-semibold\">Missao inicial</span>\n              </motion.div>\n\n              <motion.p\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                transition={{ delay: 0.7 }}\n                className=\"text-xl text-white/70\"\n              >\n                Escreva seu primeiro post. Silencio mata comunidade.\n              </motion.p>\n            </div>\n\n            {/* Botoes */}\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.9 }}\n              className=\"space-y-4\"\n            >\n              <motion.button\n                onClick={onCreatePost}\n                whileHover={{ scale: 1.02, y: -2 }}\n                whileTap={{ scale: 0.98 }}\n                className=\"w-full flex items-center justify-center gap-3 py-4 bg-[#81D8D0] text-black rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition-all\"\n              >\n                <PenTool className=\"h-5 w-5\" />\n                Escrever meu primeiro post\n              </motion.button>\n\n              <motion.button\n                onClick={onCompleteProfile}\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                className=\"w-full flex items-center justify-center gap-3 py-4 bg-white/5 border-2 border-white/20 text-white rounded-xl font-semibold text-lg hover:bg-white/10 hover:border-white/30 transition-all\"\n              >\n                <User className=\"h-5 w-5\" />\n                Completar meu perfil\n              </motion.button>\n\n              <motion.button\n                onClick={onContactFounder}\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                className=\"w-full flex items-center justify-center gap-3 py-4 bg-white/5 border-2 border-[#C8102E]/30 text-white/80 rounded-xl font-semibold text-lg hover:bg-[#C8102E]/10 hover:border-[#C8102E]/50 transition-all\"\n              >\n                <MessageCircle className=\"h-5 w-5 text-[#C8102E]\" />\n                Falar com a fundadora\n              </motion.button>\n            </motion.div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}"
}