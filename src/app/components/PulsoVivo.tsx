{
  "lote": 1,
  "status": "pending",
  "file_path": "src/app/components/PulsoVivo.tsx",
  "created_at": "2026-02-27T05:36:11.491Z",
  "file_content": "import { forwardRef, useState, useEffect } from \"react\";\nimport { motion, AnimatePresence } from \"motion/react\";\nimport {\n  Radio,\n  Video,\n  MapPin,\n  Flame,\n  Megaphone,\n  MessageCircleQuestion,\n  ArrowRight,\n  Heart,\n  Send,\n  BookOpen,\n  CalendarPlus,\n  Check,\n  Mail,\n  X,\n  ExternalLink,\n  AlertTriangle,\n  Loader2,\n  Users,\n  Lightbulb,\n} from \"lucide-react\";\nimport { supabase } from \"../../lib/supabase\";\nimport { useAnnouncements } from \"../../lib/useCMS\";\nimport type { Announcement } from \"../../lib/useCMS\";\nimport { InteractivePrompt } from \"./InteractivePrompt\";\n\n// ════════════════════════════════════════════════════════════════\n// PULSO VIVO — Corao da Landing Page\n// Lives REAIS do Supabase, mural dinmico, formulrios que salvam\n// ════════════════════════════════════════════════════════════════\n\n// Tipo das lives vindas do banco (events)\ninterface LiveFromDB {\n  id: string;\n  title: string;\n  description: string;\n  event_type: string;\n  starts_at: string;\n  ends_at: string | null;\n  status: string;\n  location_url: string;\n  location_type: string;\n  community_id: string | null;\n  host_id: string | null;\n  max_participants: number | null;\n  cover_image_url: string | null;\n  community_name?: string;\n  host_name?: string;\n  participant_count?: number;\n}\n\n// Fallback — so aparece se Supabase estiver fora / sem dados\nconst FALLBACK_LIVES = [\n  {\n    id: \"fb-1\",\n    title: \"Live — Mentes em Tensao\",\n    starts_at: \"2026-02-27T14:00:00-03:00\",\n    location_url: \"\",\n    community_name: \"Mentes em Tensao\",\n    status: \"published\",\n    destaque: true,\n    linkPublico: true,\n  },\n  {\n    id: \"fb-2\",\n    title: \"Live — Sexo, Desejo & Vinculo\",\n    starts_at: \"2026-03-02T14:00:00-03:00\",\n    location_url: \"\",\n    community_name: \"Sexo, Desejo & Vinculo\",\n    status: \"published\",\n    destaque: false,\n    linkPublico: true,\n  },\n  {\n    id: \"fb-3\",\n    title: \"Live — Networking Atipico\",\n    starts_at: \"2026-03-03T14:00:00-03:00\",\n    location_url: \"\",\n    community_name: \"Networking Atipico\",\n    status: \"published\",\n    destaque: false,\n    linkPublico: true,\n  },\n  {\n    id: \"fb-4\",\n    title: \"Live — Lab de Criacao\",\n    starts_at: \"2026-03-04T14:00:00-03:00\",\n    location_url: \"\",\n    community_name: \"Lab de Criacao\",\n    status: \"published\",\n    destaque: false,\n    linkPublico: true,\n  },\n];\n\nconst FALLBACK_AVISOS = [\n  { id: \"1\", texto: \"Cadastros abertos — primeiros 80 membros fundadores com acesso vitalicio\", tipo: \"destaque\" },\n  { id: \"2\", texto: \"10 comunidades procuram Founder — candidate-se apos o cadastro\", tipo: \"info\" },\n  { id: \"3\", texto: \"Encontro presencial Sao Paulo — Abril 2026 em organizacao\", tipo: \"evento\" },\n  { id: \"4\", texto: \"Lives toda semana — confira a agenda ao lado\", tipo: \"info\" },\n];\n\nconst DESAFIO_DA_SEMANA = {\n  titulo: \"Desafio da Semana\",\n  texto: \"Conte para alguem — pessoalmente — algo que voce costuma guardar so pra si. Nao precisa ser nada enorme. Precisa ser verdadeiro.\",\n  tag: \"Semana 1 — Fundacao\",\n};\n\nconst PERGUNTA_DO_DIA = {\n  titulo: \"Pergunta do Dia\",\n  texto: \"O que voce faria diferente na sua vida se soubesse que ninguem ia te julgar?\",\n  autor: \"Mila\",\n};\n\nfunction ActionModal({ isOpen, onClose, title, children }: { isOpen: boolean; onClose: () => void; title: string; children: React.ReactNode }) {\n  if (!isOpen) return null;\n  return (\n    <AnimatePresence>\n      <motion.div\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n        className=\"fixed inset-0 z-50 flex items-center justify-center p-4\"\n        onClick={onClose}\n      >\n        <div className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\" />\n        <motion.div\n          initial={{ scale: 0.95, opacity: 0 }}\n          animate={{ scale: 1, opacity: 1 }}\n          exit={{ scale: 0.95, opacity: 0 }}\n          onClick={(e) => e.stopPropagation()}\n          className=\"relative bg-white rounded-2xl p-6 max-w-md w-full shadow-2xl border-2 border-[#1A1A1A]/10\"\n        >\n          <button onClick={onClose} className=\"absolute top-3 right-3 p-1 hover:bg-black/5 rounded-lg transition-colors\">\n            <X className=\"h-5 w-5 text-[#666]\" />\n          </button>\n          <h3 className=\"text-lg text-[#1A1A1A] mb-4\" style={{ fontWeight: 700 }}>{title}</h3>\n          {children}\n        </motion.div>\n      </motion.div>\n    </AnimatePresence>\n  );\n}\n\n// Formatar data do banco para exibicao\nfunction formatEventDate(isoDate: string) {\n  const d = new Date(isoDate);\n  const dia = d.getDate().toString().padStart(2, \"0\");\n  const mesNum = d.getMonth(); // 0-indexed\n  const meses = [\"JAN\", \"FEV\", \"MAR\", \"ABR\", \"MAI\", \"JUN\", \"JUL\", \"AGO\", \"SET\", \"OUT\", \"NOV\", \"DEZ\"];\n  const diasSemana = [\"Domingo\", \"Segunda-feira\", \"Terca-feira\", \"Quarta-feira\", \"Quinta-feira\", \"Sexta-feira\", \"Sabado\"];\n  const hora = `${d.getHours()}h`;\n  return {\n    dia,\n    mesLabel: meses[mesNum],\n    diaSemana: diasSemana[d.getDay()],\n    hora,\n  };\n}\n\nexport const PulsoVivo = forwardRef<HTMLElement>(function PulsoVivo(_props, ref) {\n  // ═══ LIVES DO SUPABASE ═══\n  const [lives, setLives] = useState<LiveFromDB[]>([]);\n  const [livesLoading, setLivesLoading] = useState(true);\n\n  // ═══ MURAL DO SUPABASE ═══\n  const { announcements, isLoading: muralLoading } = useAnnouncements();\n\n  // ═══ INTERACAO ═══\n  const [interesseLives, setInteresseLives] = useState<Record<string, boolean>>({});\n  const [activeModal, setActiveModal] = useState<string | null>(null);\n  const [liveInterestTarget, setLiveInterestTarget] = useState<string>(\"\"); // titulo da live sendo registrada\n  const [formData, setFormData] = useState({ nome: \"\", email: \"\", mensagem: \"\" });\n  const [formSent, setFormSent] = useState<Record<string, boolean>>({});\n  const [formLoading, setFormLoading] = useState(false);\n  const [spInteresse, setSpInteresse] = useState(false);\n\n  // ═══ CARREGAR LIVES DO BANCO ═══\n  useEffect(() => {\n    let cancelled = false;\n\n    async function loadLives() {\n      try {\n        // Query publica — nao precisa de auth para SELECT se RLS permitir\n        const { data: eventsData, error } = await supabase\n          .from(\"events\")\n          .select(\"*\")\n          .in(\"status\", [\"published\", \"live\"])\n          .gte(\"starts_at\", new Date().toISOString())\n          .order(\"starts_at\", { ascending: true })\n          .limit(10);\n\n        if (error) throw error;\n        if (cancelled) return;\n\n        if (eventsData && eventsData.length > 0) {\n          // Buscar nomes de comunidades e hosts\n          const communityIds = [...new Set(eventsData.map((e: any) => e.community_id).filter(Boolean))];\n          const hostIds = [...new Set(eventsData.map((e: any) => e.host_id).filter(Boolean))];\n\n          const [commResult, hostResult, partResult] = await Promise.all([\n            communityIds.length > 0\n              ? supabase.from(\"communities\").select(\"id, name\").in(\"id\", communityIds)\n              : { data: [] },\n            hostIds.length > 0\n              ? supabase.from(\"users\").select(\"id, name\").in(\"id\", hostIds)\n              : { data: [] },\n            supabase\n              .from(\"event_participants\")\n              .select(\"event_id\")\n              .in(\"event_id\", eventsData.map((e: any) => e.id))\n              .neq(\"status\", \"cancelled\"),\n          ]);\n\n          const commMap: Record<string, string> = {};\n          (commResult.data || []).forEach((c: any) => { commMap[c.id] = c.name; });\n\n          const hostMap: Record<string, string> = {};\n          (hostResult.data || []).forEach((h: any) => { hostMap[h.id] = h.name; });\n\n          // Contagem de participantes\n          const countMap: Record<string, number> = {};\n          (partResult.data || []).forEach((p: any) => {\n            countMap[p.event_id] = (countMap[p.event_id] || 0) + 1;\n          });\n\n          const enriched: LiveFromDB[] = eventsData.map((e: any) => ({\n            ...e,\n            community_name: e.community_id ? commMap[e.community_id] || null : null,\n            host_name: e.host_id ? hostMap[e.host_id] || \"Mila\" : \"Mila\",\n            participant_count: countMap[e.id] || 0,\n          }));\n\n          setLives(enriched);\n        }\n      } catch (err) {\n        console.error(\"[PulsoVivo] Erro ao carregar lives:\", err);\n        // Fallback silencioso — landing nao pode quebrar\n      } finally {\n        if (!cancelled) setLivesLoading(false);\n      }\n    }\n\n    loadLives();\n    return () => { cancelled = true; };\n  }, []);\n\n  // ═══ TOGGLE INTERESSE (salva no banco se possivel) ═══\n  const toggleInteresse = async (eventId: string) => {\n    const isInterested = interesseLives[eventId];\n\n    // Toggle visual imediato\n    setInteresseLives(prev => ({ ...prev, [eventId]: !prev[eventId] }));\n\n    // Tentar salvar no banco (se usuario estiver logado)\n    try {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) return; // visitante — salvar so local\n\n      if (!isInterested) {\n        // Salvar interesse\n        await supabase.from(\"event_participants\").upsert(\n          { event_id: eventId, user_id: user.id, status: \"interested\" },\n          { onConflict: \"event_id,user_id\" }\n        );\n      } else {\n        // Remover interesse\n        await supabase.from(\"event_participants\")\n          .delete()\n          .eq(\"event_id\", eventId)\n          .eq(\"user_id\", user.id);\n      }\n    } catch {\n      // Falhou — manter visual, nao punir usuario\n    }\n  };\n\n  // ═══ FORM SUBMIT — SALVA NO SUPABASE ═══\n  const handleFormSubmit = async (tipo: string) => {\n    setFormLoading(true);\n    try {\n      // Mapear tipo para reason do contact_requests\n      const reasonMap: Record<string, string> = {\n        contato: \"feedback\",\n        historia: \"other\",\n        evento: \"other\",\n        denuncia: \"other\",\n        tema_live: \"other\",\n        live_interesse: \"other\",\n      };\n\n      // Montar mensagem completa com dados do visitante\n      const fullMessage = [\n        `[${tipo.toUpperCase()}]`,\n        tipo === \"live_interesse\" ? `Live: ${liveInterestTarget}` : null,\n        formData.nome ? `Nome: ${formData.nome}` : null,\n        formData.email ? `Email: ${formData.email}` : null,\n        formData.mensagem ? `\\n${formData.mensagem}` : null,\n      ].filter(Boolean).join(\" | \");\n\n      // Tentar pegar user_id se estiver logado\n      let userId: string | null = null;\n      try {\n        const { data: { user } } = await supabase.auth.getUser();\n        userId = user?.id || null;\n      } catch { /* visitante */ }\n\n      // Inserir no contact_requests\n      await supabase.from(\"contact_requests\").insert({\n        user_id: userId,\n        reason: reasonMap[tipo] || \"other\",\n        message: fullMessage,\n        status: \"pending\",\n      });\n    } catch (err) {\n      console.error(\"[PulsoVivo] Erro ao enviar formulario:\", err);\n      // Mostrar sucesso mesmo se falhar — nao punir usuario\n    } finally {\n      setFormLoading(false);\n      setFormSent(prev => ({ ...prev, [tipo]: true }));\n      setFormData({ nome: \"\", email: \"\", mensagem: \"\" });\n      setTimeout(() => setActiveModal(null), 1500);\n    }\n  };\n\n  // ═══ MURAL: USAR SUPABASE OU FALLBACK ═══\n  const muralItems = announcements.length > 0\n    ? announcements.map((a: Announcement) => ({\n        id: a.id,\n        texto: a.content || a.title,\n        tipo: a.announcement_type === \"urgent\" ? \"destaque\"\n            : a.announcement_type === \"celebration\" ? \"destaque\"\n            : a.announcement_type === \"warning\" ? \"evento\"\n            : \"info\",\n      }))\n    : FALLBACK_AVISOS;\n\n  // ═══ LIVES: USAR SUPABASE OU FALLBACK ═══\n  const displayLives = lives.length > 0 ? lives : (livesLoading ? [] : FALLBACK_LIVES);\n\n  const inputClass = \"w-full px-4 py-2.5 bg-[#EBEBEB] border-2 border-[#1A1A1A]/10 rounded-xl text-[#1A1A1A] text-sm placeholder:text-[#999] focus:border-[#1A1A1A]/25 focus:outline-none transition-colors\";\n\n  return (\n    <section ref={ref} className=\"w-full py-10 md:py-16 relative overflow-hidden\" style={{ background: \"#D4D4D4\" }}>\n      <div className=\"relative mx-auto max-w-[1200px] px-6 lg:px-8\">\n\n        {/* HEADER */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          whileInView={{ opacity: 1, y: 0 }}\n          viewport={{ once: true }}\n          className=\"text-center mb-8\"\n        >\n          <div className=\"inline-flex items-center gap-3 px-5 py-2.5 bg-[#1A1A1A] rounded-full mb-5 shadow-lg\">\n            <motion.div animate={{ scale: [1, 1.4, 1] }} transition={{ duration: 1.5, repeat: Infinity }}>\n              <Radio className=\"h-5 w-5 text-[#C8102E]\" />\n            </motion.div>\n            <span className=\"text-sm text-white tracking-wider uppercase\" style={{ fontWeight: 700 }}>\n              Acontecendo agora\n            </span>\n            <motion.div\n              animate={{ opacity: [1, 0.3, 1] }}\n              transition={{ duration: 1, repeat: Infinity }}\n              className=\"w-2 h-2 bg-[#C8102E] rounded-full\"\n            />\n          </div>\n\n          <h2 className=\"text-3xl md:text-4xl text-[#1A1A1A] mb-2\" style={{ fontWeight: 700 }}>\n            Isso aqui e <span className=\"text-[#C8102E]\">vivo</span>\n          </h2>\n          <p className=\"text-base text-[#555] max-w-xl mx-auto\">\n            Lives confirmadas, desafios, perguntas e avisos. Tudo real, tudo aberto.\n          </p>\n        </motion.div>\n\n        {/* ═══ GRID PRINCIPAL ═══ */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-5\">\n\n          {/* ═══ COLUNA 1: LIVES AGENDADAS (2/3) ═══ */}\n          <div className=\"lg:col-span-2 space-y-4\">\n            <div className=\"flex items-center justify-between mb-1\">\n              <h3 className=\"text-xs text-[#1A1A1A] uppercase tracking-[0.2em] flex items-center gap-2\" style={{ fontWeight: 700 }}>\n                <Video className=\"h-4 w-4 text-[#C8102E]\" />\n                Lives & Eventos\n              </h3>\n              {lives.length > 0 && (\n                <span className=\"text-[10px] text-[#0A8F85] bg-[#81D8D0]/15 px-2 py-0.5 rounded-full border border-[#81D8D0]/20\" style={{ fontWeight: 600 }}>\n                  Dados ao vivo\n                </span>\n              )}\n            </div>\n\n            {livesLoading ? (\n              <div className=\"bg-white border-2 border-[#1A1A1A]/10 rounded-2xl p-8 text-center\">\n                <Loader2 className=\"h-8 w-8 animate-spin mx-auto text-[#C8102E] mb-3\" />\n                <p className=\"text-sm text-[#999]\">Carregando agenda...</p>\n              </div>\n            ) : displayLives.length === 0 ? (\n              <div className=\"bg-white border-2 border-[#1A1A1A]/10 rounded-2xl p-8 text-center\">\n                <Video className=\"h-10 w-10 text-[#CCC] mx-auto mb-3\" />\n                <p className=\"text-sm text-[#999]\">Nenhum evento agendado no momento. Volte em breve!</p>\n              </div>\n            ) : (\n              <div className=\"space-y-3\">\n                {displayLives.map((live: any, idx: number) => {\n                  const temInteresse = interesseLives[live.id];\n                  const dt = formatEventDate(live.starts_at);\n                  const isDestaque = (live as any).destaque ?? idx === 0;\n                  const linkLive = live.location_url || live.linkLive || \"\";\n                  const communityName = live.community_name || null;\n                  const hostName = live.host_name || \"Mila\";\n                  const participantCount = live.participant_count || 0;\n\n                  return (\n                    <motion.div\n                      key={live.id}\n                      initial={{ opacity: 0, x: -20 }}\n                      whileInView={{ opacity: 1, x: 0 }}\n                      viewport={{ once: true }}\n                      transition={{ duration: 0.4, delay: idx * 0.08 }}\n                      whileHover={{ scale: 1.005 }}\n                      className={`group bg-white border-2 rounded-2xl p-4 md:p-5 transition-all duration-300 shadow-sm hover:shadow-md ${\n                        isDestaque ? \"border-[#1A1A1A]/25\" : \"border-[#1A1A1A]/10\"\n                      }`}\n                    >\n                      <div className=\"flex gap-4\">\n                        {/* DATE BLOCK */}\n                        <div className={`flex-shrink-0 w-16 md:w-20 text-center rounded-xl p-2 md:p-3 ${\n                          isDestaque ? \"bg-[#1A1A1A]\" : \"bg-[#EBEBEB]\"\n                        }`}>\n                          <span className={`block text-xl md:text-2xl ${isDestaque ? \"text-white\" : \"text-[#1A1A1A]\"}`} style={{ fontWeight: 700 }}>\n                            {dt.dia}\n                          </span>\n                          <span className={`block text-[10px] uppercase tracking-wider ${isDestaque ? \"text-[#C8102E]\" : \"text-[#999]\"}`} style={{ fontWeight: 600 }}>\n                            {dt.mesLabel}\n                          </span>\n                          <span className={`block text-xs mt-0.5 ${isDestaque ? \"text-white/70\" : \"text-[#999]\"}`} style={{ fontWeight: 600 }}>\n                            {dt.hora}\n                          </span>\n                        </div>\n\n                        {/* CONTENT */}\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center gap-2 mb-1.5 flex-wrap\">\n                            <span className=\"text-[10px] uppercase tracking-wider px-2 py-0.5 bg-[#C8102E] text-white rounded-full\" style={{ fontWeight: 700 }}>\n                              {live.event_type === \"ritual\" ? \"RITUAL\" : live.event_type === \"workshop\" ? \"WORKSHOP\" : \"LIVE\"}\n                            </span>\n                            <span className=\"text-[10px] text-[#999] uppercase\">{dt.diaSemana}</span>\n                            {live.status === \"live\" && (\n                              <span className=\"text-[10px] uppercase tracking-wider px-2 py-0.5 bg-[#C8102E] text-white rounded-full animate-pulse\" style={{ fontWeight: 700 }}>\n                                AO VIVO\n                              </span>\n                            )}\n                          </div>\n\n                          <h4 className=\"text-[#1A1A1A] text-base md:text-lg mb-1\" style={{ fontWeight: 600 }}>\n                            {live.title}\n                          </h4>\n\n                          <div className=\"flex items-center gap-3 text-sm text-[#666] mb-2 flex-wrap\">\n                            {communityName && (\n                              <span>Comunidade: <span className=\"text-[#1A1A1A]\" style={{ fontWeight: 600 }}>{communityName}</span></span>\n                            )}\n                            <span className=\"text-[#999]\">Host: {hostName}</span>\n                            {participantCount > 0 && (\n                              <span className=\"flex items-center gap-1 text-[#0A8F85]\">\n                                <Users className=\"h-3 w-3\" /> {participantCount}\n                              </span>\n                            )}\n                          </div>\n\n                          {/* LINK DA LIVE + INTERESSE — coleta dados reais */}\n                          <div className=\"flex flex-wrap items-center gap-2 mt-2\">\n                            {linkLive ? (\n                              <a\n                                href={linkLive}\n                                target=\"_blank\"\n                                rel=\"noopener noreferrer\"\n                                className=\"inline-flex items-center gap-1.5 px-4 py-1.5 rounded-lg text-xs bg-[#C8102E] text-white hover:bg-[#A00D24] transition-colors\"\n                                style={{ fontWeight: 600 }}\n                              >\n                                <ExternalLink className=\"h-3 w-3\" />\n                                Acessar Live\n                              </a>\n                            ) : (\n                              <button\n                                onClick={() => {\n                                  setLiveInterestTarget(live.title);\n                                  setActiveModal(\"live_interesse\");\n                                }}\n                                className=\"inline-flex items-center gap-1.5 px-4 py-1.5 rounded-lg text-xs bg-[#1A1A1A] text-white hover:bg-[#333] transition-colors cursor-pointer\"\n                                style={{ fontWeight: 600 }}\n                              >\n                                <Mail className=\"h-3 w-3\" />\n                                Quero receber o link\n                              </button>\n                            )}\n\n                            <motion.button\n                              onClick={() => {\n                                setLiveInterestTarget(live.title);\n                                setActiveModal(\"live_interesse\");\n                              }}\n                              whileTap={{ scale: 0.95 }}\n                              className={`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs transition-all border ${\n                                interesseLives[live.id]\n                                  ? \"bg-[#0A8F85] text-white border-[#0A8F85]\"\n                                  : \"bg-white text-[#555] border-[#1A1A1A]/15 hover:border-[#1A1A1A]/30 hover:text-[#1A1A1A]\"\n                              }`}\n                              style={{ fontWeight: 600 }}\n                            >\n                              {interesseLives[live.id] ? (\n                                <><Check className=\"h-3 w-3\" /> Interesse registrado!</>\n                              ) : (\n                                <><Heart className=\"h-3 w-3\" /> Quero participar</>\n                              )}\n                            </motion.button>\n                          </div>\n                        </div>\n                      </div>\n                    </motion.div>\n                  );\n                })}\n              </div>\n            )}\n\n            {/* ═══ TOPICO OFICIAL: SP ═══ */}\n            <motion.div\n              initial={{ opacity: 0, y: 15 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              viewport={{ once: true }}\n              className=\"bg-white border-2 border-[#1A1A1A]/20 rounded-2xl p-5 shadow-sm\"\n            >\n              <div className=\"flex items-center gap-2 mb-3\">\n                <div className=\"w-8 h-8 rounded-lg bg-[#FF6B35]/15 flex items-center justify-center border border-[#FF6B35]/30\">\n                  <MapPin className=\"h-4 w-4 text-[#FF6B35]\" />\n                </div>\n                <div>\n                  <span className=\"text-[10px] text-[#FF6B35] uppercase tracking-wider\" style={{ fontWeight: 700 }}>Topico Oficial</span>\n                  <h4 className=\"text-[#1A1A1A]\" style={{ fontWeight: 700 }}>Quem e de SP ou regiao? Se manifeste!</h4>\n                </div>\n              </div>\n              <p className=\"text-sm text-[#555] mb-3\">\n                Encontro presencial em Sao Paulo — Abril 2026. Precisamos saber quem ta por perto. Se manifeste!\n              </p>\n              <motion.button\n                onClick={() => setSpInteresse(!spInteresse)}\n                whileTap={{ scale: 0.95 }}\n                className={`inline-flex items-center gap-1.5 px-4 py-2 rounded-lg text-sm transition-all border-2 ${\n                  spInteresse\n                    ? \"bg-[#1A1A1A] text-white border-[#1A1A1A]\"\n                    : \"bg-white text-[#FF6B35] border-[#FF6B35]/30 hover:border-[#FF6B35]/60\"\n                }`}\n                style={{ fontWeight: 600 }}\n              >\n                {spInteresse ? (\n                  <><Check className=\"h-4 w-4\" /> Manifestei interesse!</>\n                ) : (\n                  <><MapPin className=\"h-4 w-4\" /> Sou de SP / regiao — quero participar</>\n                )}\n              </motion.button>\n            </motion.div>\n          </div>\n\n          {/* ═══ COLUNA 2: MURAL + DESAFIO + PERGUNTA + ACOES ═══ */}\n          <div className=\"space-y-4\">\n\n            {/* MURAL DE AVISOS — do Supabase */}\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              viewport={{ once: true }}\n              className=\"bg-[#1A1A1A] border-2 border-[#1A1A1A] rounded-2xl p-5\"\n            >\n              <div className=\"flex items-center gap-2 mb-4\">\n                <div className=\"w-8 h-8 rounded-lg bg-[#C8102E] flex items-center justify-center\">\n                  <Megaphone className=\"h-4 w-4 text-white\" />\n                </div>\n                <h3 className=\"text-white text-sm\" style={{ fontWeight: 700 }}>Mural de Avisos</h3>\n                {announcements.length > 0 && (\n                  <span className=\"text-[8px] text-[#81D8D0] uppercase tracking-wider ml-auto\" style={{ fontWeight: 600 }}>AO VIVO</span>\n                )}\n              </div>\n              {muralLoading ? (\n                <div className=\"flex items-center gap-2 py-2\">\n                  <Loader2 className=\"h-4 w-4 animate-spin text-white/40\" />\n                  <span className=\"text-xs text-white/40\">Carregando...</span>\n                </div>\n              ) : (\n                <div className=\"space-y-3\">\n                  {muralItems.map((aviso: any) => (\n                    <div key={aviso.id} className=\"flex items-start gap-2.5\">\n                      <ArrowRight\n                        className=\"h-3 w-3 mt-1 flex-shrink-0\"\n                        style={{\n                          color: aviso.tipo === \"destaque\" ? \"#C8102E\" : aviso.tipo === \"evento\" ? \"#FF6B35\" : \"#81D8D0\",\n                        }}\n                      />\n                      <p className={`text-sm leading-relaxed ${aviso.tipo === \"destaque\" ? \"text-white\" : \"text-white/70\"}`}\n                        style={aviso.tipo === \"destaque\" ? { fontWeight: 600 } : {}}\n                      >\n                        {aviso.texto}\n                      </p>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </motion.div>\n\n            {/* DESAFIO DA SEMANA — INTERATIVO: qualquer pessoa pode responder */}\n            <InteractivePrompt\n              promptType=\"desafio\"\n              title={DESAFIO_DA_SEMANA.titulo}\n              subtitle={DESAFIO_DA_SEMANA.tag}\n              text={DESAFIO_DA_SEMANA.texto}\n              icon={\n                <div className=\"w-8 h-8 rounded-lg bg-[#C8102E]/15 flex items-center justify-center border border-[#C8102E]/20\">\n                  <Flame className=\"h-4 w-4 text-[#C8102E]\" />\n                </div>\n              }\n              borderColor=\"#C8102E40\"\n              accentColor=\"#C8102E\"\n            />\n\n            {/* PERGUNTA DO DIA — INTERATIVO: qualquer pessoa pode responder */}\n            <InteractivePrompt\n              promptType=\"pergunta\"\n              title={PERGUNTA_DO_DIA.titulo}\n              text={PERGUNTA_DO_DIA.texto}\n              author={PERGUNTA_DO_DIA.autor}\n              icon={\n                <div className=\"w-8 h-8 rounded-lg bg-[#81D8D0]/20 flex items-center justify-center border border-[#81D8D0]/30\">\n                  <MessageCircleQuestion className=\"h-4 w-4 text-[#0A8F85]\" />\n                </div>\n              }\n              borderColor=\"#81D8D040\"\n              accentColor=\"#0A8F85\"\n            />\n\n            {/* ═══ SUGERIR TEMA PARA LIVE — DESTAQUE ═══ */}\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              viewport={{ once: true }}\n              className=\"bg-gradient-to-br from-[#C8102E] to-[#8B0A1E] rounded-2xl p-5 text-white shadow-md\"\n            >\n              <div className=\"flex items-center gap-2 mb-3\">\n                <div className=\"w-8 h-8 rounded-lg bg-white/15 flex items-center justify-center\">\n                  <Lightbulb className=\"h-4 w-4 text-white\" />\n                </div>\n                <h3 className=\"text-sm text-white\" style={{ fontWeight: 700 }}>Sugira um tema para live</h3>\n              </div>\n              <p className=\"text-xs text-white/70 mb-3 leading-relaxed\">\n                Que assunto voce gostaria de ver numa live? Sua sugestao vai direto pra equipe e influencia a agenda.\n              </p>\n              <button\n                onClick={() => setActiveModal(\"tema_live\")}\n                className=\"w-full py-2.5 bg-white text-[#C8102E] rounded-xl text-sm transition-all hover:bg-white/90 cursor-pointer\"\n                style={{ fontWeight: 700 }}\n              >\n                Enviar minha sugestao\n              </button>\n            </motion.div>\n\n            {/* ═══ ACOES INTERATIVAS ═══ */}\n            <motion.div\n              initial={{ opacity: 0, y: 20 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              viewport={{ once: true }}\n              className=\"bg-white border-2 border-[#1A1A1A]/10 rounded-2xl p-5\"\n            >\n              <h3 className=\"text-[#1A1A1A] text-sm mb-3\" style={{ fontWeight: 700 }}>Participe</h3>\n              <div className=\"grid grid-cols-2 gap-2\">\n                {[\n                  { key: \"contato\", icon: Mail, color: \"#81D8D0\", label: \"Falar com a equipe\" },\n                  { key: \"historia\", icon: BookOpen, color: \"#C8102E\", label: \"Contar sua historia\" },\n                  { key: \"evento\", icon: CalendarPlus, color: \"#FF6B35\", label: \"Sugerir evento\" },\n                  { key: \"denuncia\", icon: AlertTriangle, color: \"#C8102E\", label: \"Fazer denuncia\" },\n                ].map(action => (\n                  <button\n                    key={action.key}\n                    onClick={() => setActiveModal(action.key)}\n                    className=\"flex flex-col items-center gap-1.5 p-3 rounded-xl bg-[#EBEBEB] hover:bg-[#DCDCDC] border border-[#1A1A1A]/8 transition-colors text-center\"\n                  >\n                    <action.icon className=\"h-5 w-5\" style={{ color: action.color }} />\n                    <span className=\"text-[11px] text-[#444]\" style={{ fontWeight: 600 }}>{action.label}</span>\n                  </button>\n                ))}\n              </div>\n            </motion.div>\n          </div>\n        </div>\n      </div>\n\n      {/* ═══ MODALS — SALVAM NO SUPABASE ═══ */}\n      {[\"contato\", \"historia\", \"evento\", \"denuncia\", \"tema_live\"].map(tipo => {\n        const config: Record<string, { title: string; placeholder: string; btnText: string; btnColor: string; successMsg: string; description: string }> = {\n          contato: { title: \"Falar com a equipe\", placeholder: \"Sua mensagem\", btnText: \"Enviar\", btnColor: \"#1A1A1A\", successMsg: \"Mensagem enviada!\", description: \"\" },\n          historia: { title: \"Conte sua historia\", placeholder: \"Sua historia...\", btnText: \"Enviar minha historia\", btnColor: \"#C8102E\", successMsg: \"Historia recebida!\", description: \"Compartilhe um pouco de quem voce e. Nao precisa ser longo — precisa ser real.\" },\n          evento: { title: \"Sugerir um evento\", placeholder: \"Descreva sua ideia...\", btnText: \"Enviar sugestao\", btnColor: \"#FF6B35\", successMsg: \"Sugestao enviada!\", description: \"Tem uma ideia de live, debate, ritual ou encontro? Conta pra gente.\" },\n          denuncia: { title: \"Fazer denuncia\", placeholder: \"Descreva a situacao...\", btnText: \"Enviar denuncia\", btnColor: \"#C8102E\", successMsg: \"Denuncia recebida. Vamos avaliar.\", description: \"Relatos sao tratados com seriedade e sigilo. Descreva o que aconteceu.\" },\n          tema_live: { title: \"Sugira um tema para live\", placeholder: \"Assunto da live...\", btnText: \"Enviar sugestao\", btnColor: \"#C8102E\", successMsg: \"Sugestao enviada!\", description: \"Que assunto voce gostaria de ver numa live? Sua sugestao vai direto pra equipe e influencia a agenda.\" },\n        };\n        const c = config[tipo];\n        return (\n          <ActionModal key={tipo} isOpen={activeModal === tipo} onClose={() => setActiveModal(null)} title={c.title}>\n            {formSent[tipo] ? (\n              <div className=\"text-center py-4\">\n                <Check className=\"h-10 w-10 mx-auto mb-3\" style={{ color: c.btnColor }} />\n                <p className=\"text-[#1A1A1A]\" style={{ fontWeight: 600 }}>{c.successMsg}</p>\n              </div>\n            ) : (\n              <div className=\"space-y-3\">\n                {c.description && <p className=\"text-sm text-[#666]\">{c.description}</p>}\n                <input type=\"text\" placeholder=\"Seu nome\" value={formData.nome} onChange={(e) => setFormData(prev => ({ ...prev, nome: e.target.value }))} className={inputClass} />\n                <input type=\"email\" placeholder=\"Seu email\" value={formData.email} onChange={(e) => setFormData(prev => ({ ...prev, email: e.target.value }))} className={inputClass} />\n                <textarea placeholder={c.placeholder} value={formData.mensagem} onChange={(e) => setFormData(prev => ({ ...prev, mensagem: e.target.value }))} rows={tipo === \"historia\" ? 5 : 3} className={`${inputClass} resize-none`} />\n                <button\n                  onClick={() => handleFormSubmit(tipo)}\n                  disabled={formLoading}\n                  className=\"w-full py-2.5 text-white rounded-xl text-sm transition-colors hover:opacity-90 disabled:opacity-50\"\n                  style={{ fontWeight: 600, backgroundColor: c.btnColor }}\n                >\n                  <span className=\"flex items-center justify-center gap-2\">\n                    {formLoading ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Send className=\"h-4 w-4\" />}\n                    {formLoading ? \"Enviando...\" : c.btnText}\n                  </span>\n                </button>\n              </div>\n            )}\n          </ActionModal>\n        );\n      })}\n\n      {/* ═══ MODAL INTERESSE EM LIVE — coleta dados reais de visitantes ═══ */}\n      <ActionModal\n        isOpen={activeModal === \"live_interesse\"}\n        onClose={() => setActiveModal(null)}\n        title=\"Quero participar desta live\"\n      >\n        {formSent[\"live_interesse\"] ? (\n          <div className=\"text-center py-4\">\n            <Check className=\"h-10 w-10 mx-auto mb-3 text-[#0A8F85]\" />\n            <p className=\"text-[#1A1A1A]\" style={{ fontWeight: 600 }}>Interesse registrado!</p>\n            <p className=\"text-sm text-[#666] mt-1\">Voce recebera o link por email quando a live for confirmada.</p>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            <div className=\"bg-[#EBEBEB] rounded-xl p-3 mb-1\">\n              <p className=\"text-xs text-[#999] uppercase tracking-wider mb-1\" style={{ fontWeight: 600 }}>Live selecionada</p>\n              <p className=\"text-sm text-[#1A1A1A]\" style={{ fontWeight: 600 }}>{liveInterestTarget}</p>\n            </div>\n            <p className=\"text-sm text-[#666]\">\n              Deixe seus dados para receber o link e atualizacoes sobre esta live.\n            </p>\n            <input type=\"text\" placeholder=\"Seu nome\" value={formData.nome} onChange={(e) => setFormData(prev => ({ ...prev, nome: e.target.value }))} className={inputClass} />\n            <input type=\"email\" placeholder=\"Seu email (obrigatorio)\" value={formData.email} onChange={(e) => setFormData(prev => ({ ...prev, email: e.target.value }))} className={inputClass} />\n            <button\n              onClick={() => handleFormSubmit(\"live_interesse\")}\n              disabled={formLoading || !formData.email.includes(\"@\")}\n              className=\"w-full py-2.5 bg-[#1A1A1A] text-white rounded-xl text-sm transition-colors hover:bg-[#333] disabled:opacity-50\"\n              style={{ fontWeight: 600 }}\n            >\n              <span className=\"flex items-center justify-center gap-2\">\n                {formLoading ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Heart className=\"h-4 w-4\" />}\n                {formLoading ? \"Registrando...\" : \"Confirmar interesse\"}\n              </span>\n            </button>\n          </div>\n        )}\n      </ActionModal>\n    </section>\n  );\n});"
}