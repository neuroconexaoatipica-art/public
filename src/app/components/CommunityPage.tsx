{
  "lote": 4,
  "status": "pending",
  "file_path": "src/app/components/CommunityPage.tsx",
  "created_at": "2026-02-27T05:36:19.699Z",
  "file_content": "import { useState, useEffect, useRef } from \"react\";\nimport { motion, AnimatePresence } from \"motion/react\";\nimport {\n  ArrowLeft, MessageCircle, BookOpen, Video, Flame, Lock,\n  MessageSquare, PlusCircle, Image, Camera, Sparkles, Users,\n  Mail, CalendarPlus, AlertTriangle, X, Loader2, Check,\n  Heart, ExternalLink, ShieldCheck, Send, Radio, Calendar,\n  Mic, Lightbulb\n} from \"lucide-react\";\nimport { supabase } from \"../../lib/supabase\";\nimport { useProfileContext, hasAppAccess, hasModAccess, isSuperAdmin, usePosts } from \"../../lib\";\nimport { useEvents } from \"../../lib/useEvents\";\nimport { useChat } from \"../../lib/useChat\";\nimport type { EventWithMeta } from \"../../lib/useEvents\";\nimport type { CommunityWithMeta } from \"../../lib\";\nimport { MILA_UUID, MILA_ACTIVE_COMMUNITIES, COMMUNITY_RITUAL_TYPES } from \"../../lib/communitiesConfig\";\nimport { PostCard } from \"./PostCard\";\nimport { CreatePostModal } from \"./CreatePostModal\";\nimport { UserAvatar } from \"./UserAvatar\";\nimport { MembershipGate } from \"./MembershipGate\";\nimport { FounderPanel } from \"./FounderPanel\";\nimport { CommunityNarratives } from \"./CommunityNarratives\";\n\ninterface CommunityPageProps {\n  community: CommunityWithMeta;\n  onBack: () => void;\n  onNavigateToProfile: (userId: string) => void;\n}\n\ntype Tab = \"mural\" | \"forum\" | \"manifesto\" | \"lives\" | \"eventos\" | \"rituais\" | \"chat\";\n\n// Rituais agora vem da config centralizada (communitiesConfig.ts)\nconst RITUAIS = COMMUNITY_RITUAL_TYPES;\n\nfunction formatEventDate(isoDate: string) {\n  const d = new Date(isoDate);\n  const dia = d.getDate().toString().padStart(2, \"0\");\n  const meses = [\"JAN\", \"FEV\", \"MAR\", \"ABR\", \"MAI\", \"JUN\", \"JUL\", \"AGO\", \"SET\", \"OUT\", \"NOV\", \"DEZ\"];\n  const hora = `${d.getHours()}h${d.getMinutes().toString().padStart(2, \"0\")}`;\n  return { dia, mesLabel: meses[d.getMonth()], hora };\n}\n\nexport function CommunityPage({ community, onBack, onNavigateToProfile }: CommunityPageProps) {\n  const [isCreatePostOpen, setIsCreatePostOpen] = useState(false);\n  const [activeTab, setActiveTab] = useState<Tab>(\"mural\");\n  const [activeModal, setActiveModal] = useState<string | null>(null);\n  const [formData, setFormData] = useState({ nome: \"\", email: \"\", mensagem: \"\", tema: \"\", horario: \"\" });\n  const [formSent, setFormSent] = useState<Record<string, boolean>>({});\n  const [formLoading, setFormLoading] = useState(false);\n  const [chatInput, setChatInput] = useState(\"\");\n  const [sendingChat, setSendingChat] = useState(false);\n  const [showNarratives, setShowNarratives] = useState(false);\n  const chatEndRef = useRef<HTMLDivElement>(null);\n\n  const { user } = useProfileContext();\n  const canPost = hasAppAccess(user?.role);\n  const canModerate = hasModAccess(user?.role);\n  const isAdmin = isSuperAdmin(user?.role);\n\n  const isRealCommunity = !community.id.startsWith(\"pending-\") && !community.id.startsWith(\"local-\");\n\n  // ═══ DETECTAR SE É COMUNIDADE ATIVA DA MILA ═══\n  const isMilaActive = MILA_ACTIVE_COMMUNITIES.includes(community.name);\n  const effectiveOwnerId = isMilaActive ? (community.owner_id || MILA_UUID) : community.owner_id;\n\n  // ═══ MODERADOR INFO ═══\n  const [ownerData, setOwnerData] = useState<{ name: string; photo: string | null } | null>(null);\n\n  useEffect(() => {\n    if (!effectiveOwnerId) return;\n    supabase\n      .from(\"users\")\n      .select(\"name, profile_photo\")\n      .eq(\"id\", effectiveOwnerId)\n      .single()\n      .then(({ data }) => {\n        if (data) setOwnerData({ name: data.name, photo: data.profile_photo });\n      });\n  }, [effectiveOwnerId]);\n\n  // ═══ MANIFESTO ═══\n  const manifesto = community.manifesto_text && community.manifesto_text.trim().length > 0\n    ? community.manifesto_text\n    : community.description;\n\n  // ═══ POSTS DO MURAL ═══\n  const { posts, isLoading, isLoadingMore, hasMore, loadMore, refreshPosts } = usePosts(\n    isRealCommunity ? { communityId: community.id } : {}\n  );\n  const sortedPosts = [...posts].sort((a, b) => {\n    if (a.is_pinned && !b.is_pinned) return -1;\n    if (!a.is_pinned && b.is_pinned) return 1;\n    return new Date(b.created_at).getTime() - new Date(a.created_at).getTime();\n  });\n\n  // ═══ LIVES & EVENTOS DO SUPABASE ═══\n  const { events: communityEvents, isLoading: eventsLoading, joinEvent, leaveEvent } = useEvents(\n    isRealCommunity ? { communityId: community.id, upcoming: true } : {}\n  );\n  const lives = communityEvents.filter(e => e.event_type === \"live\");\n  const eventos = communityEvents.filter(e => e.event_type !== \"live\");\n\n  // ═══ CHAT EM GRUPO ═══\n  const { messages: chatMessages, isLoading: chatLoading, sendMessage } = useChat(\n    isRealCommunity ? community.id : null\n  );\n\n  useEffect(() => {\n    if (activeTab === \"chat\") {\n      chatEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n    }\n  }, [chatMessages, activeTab]);\n\n  const handleSendChat = async () => {\n    if (!chatInput.trim() || sendingChat) return;\n    setSendingChat(true);\n    await sendMessage(chatInput.trim());\n    setChatInput(\"\");\n    setSendingChat(false);\n  };\n\n  const IconComponent = community.config.icon;\n\n  // ═══ TOGGLE INTERESSE EM LIVE/EVENTO ═══\n  const handleToggleEventInterest = async (event: EventWithMeta) => {\n    if (!user) return;\n    try {\n      if (event.is_participating) {\n        await leaveEvent(event.id);\n      } else {\n        await joinEvent(event.id, \"interested\");\n      }\n    } catch (err) {\n      console.error(\"[CommunityPage] Erro ao participar:\", err);\n    }\n  };\n\n  // ═══ FORM SUBMIT ═══\n  const handleFormSubmit = async (tipo: string) => {\n    setFormLoading(true);\n    try {\n      const fullMessage = [\n        `[${tipo.toUpperCase()}]`,\n        `Comunidade: ${community.name}`,\n        formData.nome ? `Nome: ${formData.nome}` : null,\n        formData.email ? `Email: ${formData.email}` : null,\n        formData.tema ? `Tema: ${formData.tema}` : null,\n        formData.horario ? `Horario sugerido: ${formData.horario}` : null,\n        formData.mensagem ? `\\n${formData.mensagem}` : null,\n      ].filter(Boolean).join(\" | \");\n\n      await supabase.from(\"contact_requests\").insert({\n        user_id: user?.id || null,\n        reason: tipo === \"denuncia\" ? \"other\" : tipo === \"live_application\" ? \"other\" : tipo === \"evento_sugestao\" ? \"other\" : tipo === \"tema_live\" ? \"other\" : \"feedback\",\n        message: fullMessage,\n        status: \"pending\",\n      });\n    } catch (err) {\n      console.error(\"[CommunityPage] Erro ao enviar formulario:\", err);\n    } finally {\n      setFormLoading(false);\n      setFormSent(prev => ({ ...prev, [tipo]: true }));\n      setFormData({ nome: \"\", email: \"\", mensagem: \"\", tema: \"\", horario: \"\" });\n      setTimeout(() => setActiveModal(null), 1500);\n    }\n  };\n\n  // ═══ ACESSO: só membros aceitos ═══\n  const isLoggedIn = !!user;\n  const hasMemberAccess = isLoggedIn && canPost;\n\n  const inputClass = \"w-full px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white text-sm placeholder:text-white/30 focus:border-[#81D8D0]/50 focus:outline-none\";\n\n  const tabs: { key: Tab; label: string; icon: typeof MessageCircle }[] = [\n    { key: \"mural\", label: \"Mural\", icon: MessageCircle },\n    { key: \"forum\", label: \"Fórum\", icon: MessageSquare },\n    { key: \"manifesto\", label: \"Manifesto\", icon: BookOpen },\n    { key: \"lives\", label: \"Lives\", icon: Radio },\n    { key: \"eventos\", label: \"Eventos\", icon: Calendar },\n    { key: \"rituais\", label: \"Rituais\", icon: Flame },\n    { key: \"chat\", label: \"Chat\", icon: MessageSquare },\n  ];\n\n  return (\n    <MembershipGate\n      communityId={isRealCommunity ? community.id : undefined}\n      communityName={community.name}\n      communityColor={community.config.color}\n      onBack={onBack}\n    >\n    <div className=\"min-h-screen bg-black\">\n      {/* ═══ HEADER ═══ */}\n      <div className=\"w-full bg-[#35363A] border-b border-white/10 sticky top-0 z-40\">\n        <div className=\"mx-auto max-w-[1200px] px-6 py-3\">\n          <div className=\"flex items-center justify-between\">\n            <button onClick={onBack} className=\"flex items-center gap-2 text-white/80 hover:text-[#81D8D0] transition-colors\">\n              <ArrowLeft className=\"h-5 w-5\" />\n              <span className=\"font-medium\">Voltar</span>\n            </button>\n            <div className=\"flex items-center gap-2\">\n              <IconComponent className=\"h-5 w-5\" style={{ color: community.config.color }} />\n              <h1 className=\"text-lg text-white font-semibold\">{community.name}</h1>\n              {isMilaActive && <span className=\"text-[9px] px-1.5 py-0.5 bg-[#81D8D0]/20 text-[#81D8D0] rounded-full font-bold\">ATIVA</span>}\n            </div>\n            <div className=\"w-20\" />\n          </div>\n        </div>\n      </div>\n\n      <div className=\"mx-auto max-w-[1200px] px-6 py-6\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\n          {/* ═══ SIDEBAR ═══ */}\n          <div className=\"space-y-4\">\n            {/* Community Card */}\n            <div className=\"bg-white/5 border border-white/10 rounded-2xl p-5\">\n              <div className=\"w-14 h-14 rounded-xl flex items-center justify-center mb-4\" style={{ backgroundColor: `${community.config.color}20`, border: `2px solid ${community.config.color}40` }}>\n                <IconComponent className=\"h-7 w-7\" style={{ color: community.config.color }} />\n              </div>\n              <h2 className=\"text-xl text-white font-bold mb-2\">{community.name}</h2>\n              <p className=\"text-sm text-white/60 leading-relaxed mb-4\">{community.description}</p>\n\n              {/* Stats */}\n              <div className=\"flex items-center gap-4 text-xs text-white/40 mb-4\">\n                <span className=\"flex items-center gap-1\"><MessageCircle className=\"h-3 w-3\" /> {community.postCount} posts</span>\n                {communityEvents.length > 0 && (\n                  <span className=\"flex items-center gap-1\"><Video className=\"h-3 w-3\" /> {communityEvents.length} eventos</span>\n                )}\n              </div>\n\n              {/* ═══ MODERADOR — com foto ═══ */}\n              {(isMilaActive || effectiveOwnerId) && (\n                <div className=\"border-t border-white/10 pt-4\">\n                  <span className=\"text-[10px] text-white/40 uppercase tracking-wider font-bold\">Moderação</span>\n                  <div className=\"flex items-center gap-3 mt-2\">\n                    <UserAvatar\n                      name={ownerData?.name || \"Mila\"}\n                      photoUrl={ownerData?.photo}\n                      size=\"md\"\n                      onClick={() => effectiveOwnerId && onNavigateToProfile(effectiveOwnerId)}\n                    />\n                    <div>\n                      <div className=\"flex items-center gap-1.5\">\n                        <span className=\"text-sm text-white font-semibold\">{ownerData?.name || \"Mila\"}</span>\n                        <ShieldCheck className=\"h-3.5 w-3.5 text-[#81D8D0]\" />\n                      </div>\n                      <span className=\"text-[10px] text-white/40\">Criadora & Moderadora</span>\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* ═══ AGUARDANDO FOUNDER — só para comunidades NÃO ativas ═══ */}\n              {!isMilaActive && community.needs_moderator && !community.owner_id && (\n                <div className=\"mt-4 border-t border-white/10 pt-4\">\n                  <motion.div\n                    animate={{ opacity: [1, 0.7, 1] }}\n                    transition={{ duration: 2, repeat: Infinity }}\n                    className=\"bg-[#C8102E]/10 border border-[#C8102E]/30 rounded-xl p-3 text-center\"\n                  >\n                    <span className=\"text-[11px] text-[#C8102E] uppercase tracking-wider font-bold\">\n                      AGUARDANDO FUNDADOR(A)\n                    </span>\n                    <p className=\"text-[10px] text-white/40 mt-1\">Esta comunidade precisa de um(a) fundador(a) para abrir</p>\n                  </motion.div>\n                </div>\n              )}\n            </div>\n\n            {/* ═══ AÇÕES ═══ */}\n            <div className=\"bg-white/5 border border-white/10 rounded-2xl p-4 space-y-2\">\n              <h3 className=\"text-xs text-white uppercase tracking-wider mb-2 font-bold\">Ações</h3>\n              {[\n                { key: \"contato\", icon: Mail, color: \"#81D8D0\", label: \"Falar com a equipe\" },\n                { key: \"tema_live\", icon: Lightbulb, color: \"#C8102E\", label: \"Sugerir tema para live\" },\n                { key: \"evento_sugestao\", icon: CalendarPlus, color: \"#FF6B35\", label: \"Sugerir evento\" },\n                { key: \"live_application\", icon: Mic, color: \"#C8102E\", label: \"Quero fazer uma Live\" },\n                { key: \"denuncia\", icon: AlertTriangle, color: \"#C8102E\", label: \"Fazer denúncia\" },\n              ].map((action) => (\n                <button\n                  key={action.key}\n                  onClick={() => hasMemberAccess ? setActiveModal(action.key) : alert(\"Faça login e aguarde aprovação para acessar.\")}\n                  className=\"flex items-center gap-2 w-full px-3 py-2 rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 transition-colors text-left\"\n                >\n                  <action.icon className=\"h-4 w-4\" style={{ color: action.color }} />\n                  <span className=\"text-xs text-white/70 font-semibold\">{action.label}</span>\n                </button>\n              ))}\n            </div>\n\n            {/* ═══ FOUNDER PANEL — visível para owner ou super_admin ═══ */}\n            {isRealCommunity && (effectiveOwnerId === user?.id || isAdmin) && (\n              <FounderPanel\n                communityId={community.id}\n                communityName={community.name}\n                communityColor={community.config.color}\n                currentManifesto={manifesto}\n                onNavigateToProfile={onNavigateToProfile}\n              />\n            )}\n\n            {/* ══ MENSAGEM PRIVADA 1:1 ═══ */}\n            <div className=\"bg-white/5 border border-white/10 rounded-2xl p-4\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <Lock className=\"h-4 w-4 text-[#81D8D0]\" />\n                <h3 className=\"text-xs text-white uppercase tracking-wider font-bold\">Chat Privado 1:1</h3>\n              </div>\n              <p className=\"text-[11px] text-white/40 leading-relaxed mb-3\">\n                Quer conversar em particular com outro membro? Acesse o perfil da pessoa e envie uma mensagem direta.\n              </p>\n              <div className=\"bg-white/5 border border-white/10 rounded-xl p-3 text-center\">\n                <MessageSquare className=\"h-5 w-5 text-white/20 mx-auto mb-1\" />\n                <span className=\"text-[10px] text-white/30 font-semibold\">Clique no avatar de um membro</span>\n              </div>\n            </div>\n          </div>\n\n          {/* ═══ MAIN CONTENT ═══ */}\n          <div className=\"lg:col-span-3\">\n            {/* ═══ TABS ═══ */}\n            <div className=\"flex items-center gap-1 bg-white/5 border border-white/10 rounded-2xl p-1.5 mb-5 overflow-x-auto\">\n              {tabs.map((tab) => (\n                <button\n                  key={tab.key}\n                  onClick={() => setActiveTab(tab.key)}\n                  className={`flex items-center gap-1.5 px-3 py-2 rounded-xl text-xs whitespace-nowrap transition-all font-semibold ${\n                    activeTab === tab.key\n                      ? \"bg-white text-black\"\n                      : \"text-white/50 hover:text-white hover:bg-white/5\"\n                  }`}\n                >\n                  <tab.icon className=\"h-3.5 w-3.5\" />\n                  {tab.label}\n                </button>\n              ))}\n            </div>\n\n            <AnimatePresence mode=\"wait\">\n              <motion.div\n                key={activeTab}\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                exit={{ opacity: 0 }}\n                transition={{ duration: 0.2 }}\n              >\n                {/* ════════════════════════════════════════\n                    TAB: MURAL\n                ════════════════════════════════════════ */}\n                {activeTab === \"mural\" && (\n                  <div className=\"space-y-4\">\n                    {isRealCommunity && user && canPost && (\n                      <div className=\"bg-white/5 border border-white/10 rounded-2xl p-4\">\n                        <button onClick={() => setIsCreatePostOpen(true)} className=\"flex items-center gap-3 w-full text-left\">\n                          <UserAvatar name={user.name} photoUrl={user.profile_photo} size=\"md\" />\n                          <span className=\"text-sm text-white/40\">Escreva algo para a comunidade...</span>\n                        </button>\n                        <div className=\"flex items-center gap-2 mt-3 pt-3 border-t border-white/10\">\n                          <button onClick={() => setIsCreatePostOpen(true)} className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-white/5 text-[11px] text-white/50 hover:bg-white/10 transition-colors font-semibold\">\n                            <Image className=\"h-3.5 w-3.5\" /> Foto\n                          </button>\n                          <button onClick={() => setIsCreatePostOpen(true)} className=\"flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-white/5 text-[11px] text-white/50 hover:bg-white/10 transition-colors font-semibold\">\n                            <Camera className=\"h-3.5 w-3.5\" /> Imagem\n                          </button>\n                          <button\n                            onClick={() => setShowNarratives(!showNarratives)}\n                            className={`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-[11px] font-semibold transition-colors ${\n                              showNarratives ? \"bg-[#FF6B35]/15 text-[#FF6B35]\" : \"bg-white/5 text-white/50 hover:bg-white/10\"\n                            }`}\n                          >\n                            <Sparkles className=\"h-3.5 w-3.5\" /> Narrativas\n                          </button>\n                        </div>\n                      </div>\n                    )}\n\n                    {/* ═══ NARRATIVAS TEMATICAS ═══ */}\n                    <AnimatePresence>\n                      {showNarratives && canPost && (\n                        <motion.div\n                          initial={{ opacity: 0, height: 0 }}\n                          animate={{ opacity: 1, height: \"auto\" }}\n                          exit={{ opacity: 0, height: 0 }}\n                          className=\"bg-white/5 border border-white/10 rounded-2xl p-5 overflow-hidden\"\n                        >\n                          <CommunityNarratives\n                            communityCategory={community.config.category}\n                            communityColor={community.config.color}\n                            onSelectNarrative={(prompt, title) => {\n                              navigator.clipboard.writeText(prompt);\n                              setShowNarratives(false);\n                              setIsCreatePostOpen(true);\n                            }}\n                          />\n                        </motion.div>\n                      )}\n                    </AnimatePresence>\n\n                    {isLoading ? (\n                      <div className=\"text-center py-12\">\n                        <div className=\"w-12 h-12 border-4 border-[#81D8D0] border-t-transparent rounded-full animate-spin mx-auto mb-4\" />\n                        <p className=\"text-white/40\">Carregando...</p>\n                      </div>\n                    ) : sortedPosts.length === 0 ? (\n                      <EmptyMural community={community} IconComponent={IconComponent} canPost={canPost} onCreatePost={() => setIsCreatePostOpen(true)} />\n                    ) : (\n                      <div className=\"space-y-4\">\n                        {sortedPosts.map((post) => (\n                          <PostCard\n                            key={post.id}\n                            post={post}\n                            currentUserId={user?.id}\n                            canModerate={canModerate}\n                            onDelete={refreshPosts}\n                            onPinToggle={refreshPosts}\n                            onAuthorClick={onNavigateToProfile}\n                          />\n                        ))}\n                        {hasMore && (\n                          <button onClick={loadMore} disabled={isLoadingMore} className=\"w-full py-3 bg-white/5 border border-white/10 rounded-xl text-sm text-white/60 hover:bg-white/10 transition-colors font-semibold\">\n                            {isLoadingMore ? \"Carregando...\" : \"Carregar mais\"}\n                          </button>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                )}\n\n                {/* ════════════════════════════════════════\n                    TAB: FÓRUM (Discussões)\n                ════════════════════════════════════════ */}\n                {activeTab === \"forum\" && (\n                  <div className=\"space-y-4\">\n                    <div className=\"bg-white/5 border border-white/10 rounded-2xl p-6\">\n                      <div className=\"flex items-center justify-between mb-4\">\n                        <h2 className=\"text-lg text-white font-bold\">Fórum de Discussão</h2>\n                        {canPost && (\n                          <button onClick={() => setIsCreatePostOpen(true)} className=\"flex items-center gap-2 px-4 py-2 bg-[#81D8D0] text-black rounded-xl text-xs font-bold hover:bg-[#81D8D0]/90 transition-colors\">\n                            <PlusCircle className=\"h-4 w-4\" /> Nova discussão\n                          </button>\n                        )}\n                      </div>\n                      <p className=\"text-sm text-white/50 mb-4\">Abra tópicos, faça perguntas, compartilhe reflexões. Aqui a conversa é mais longa e profunda.</p>\n                    </div>\n\n                    {isLoading ? (\n                      <div className=\"text-center py-12\">\n                        <Loader2 className=\"h-8 w-8 animate-spin mx-auto text-[#81D8D0] mb-3\" />\n                        <p className=\"text-sm text-white/40\">Carregando discussões...</p>\n                      </div>\n                    ) : sortedPosts.length === 0 ? (\n                      <div className=\"bg-white/5 border border-white/10 rounded-2xl p-8 text-center\">\n                        <MessageSquare className=\"h-10 w-10 text-white/20 mx-auto mb-3\" />\n                        <p className=\"text-white/50 text-sm\">Nenhuma discussão ainda. Seja a primeira pessoa a abrir um tópico!</p>\n                        {canPost && (\n                          <button onClick={() => setIsCreatePostOpen(true)} className=\"mt-4 inline-flex items-center gap-2 px-6 py-3 bg-[#81D8D0] text-black rounded-xl text-sm font-bold hover:bg-[#81D8D0]/90 transition-colors\">\n                            <PlusCircle className=\"h-5 w-5\" /> Abrir tópico\n                          </button>\n                        )}\n                      </div>\n                    ) : (\n                      <div className=\"space-y-3\">\n                        {sortedPosts.map((post) => (\n                          <div key={post.id} className=\"bg-white/5 border border-white/10 rounded-xl p-4 hover:border-white/20 transition-colors cursor-pointer\">\n                            <div className=\"flex items-start gap-3\">\n                              <UserAvatar name={post.author_data?.display_name || post.author_data?.name || \"\"} photoUrl={post.author_data?.profile_photo} size=\"sm\" onClick={() => onNavigateToProfile(post.author)} />\n                              <div className=\"flex-1 min-w-0\">\n                                <div className=\"flex items-center gap-2 mb-1\">\n                                  <span className=\"text-white font-semibold text-sm cursor-pointer hover:text-[#81D8D0]\" onClick={() => onNavigateToProfile(post.author)}>\n                                    {post.author_data?.display_name || post.author_data?.name || \"Membro\"}\n                                  </span>\n                                  <span className=\"text-white/30 text-xs\">{new Date(post.created_at).toLocaleDateString(\"pt-BR\")}</span>\n                                  {post.is_pinned && <span className=\"text-[9px] px-1.5 py-0.5 bg-[#C8102E]/20 text-[#C8102E] rounded font-bold\">FIXADO</span>}\n                                </div>\n                                <p className=\"text-white/70 text-sm line-clamp-3\">{post.content}</p>\n                                <div className=\"flex items-center gap-3 mt-2 text-xs text-white/30\">\n                                  <span className=\"flex items-center gap-1\"><MessageCircle className=\"h-3 w-3\" /> Comentar</span>\n                                  <span className=\"flex items-center gap-1\"><Heart className=\"h-3 w-3\" /> Reagir</span>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                )}\n\n                {/* ════════════════════════════════════════\n                    TAB: MANIFESTO\n                ════════════════════════════════════════ */}\n                {activeTab === \"manifesto\" && (\n                  <div className=\"bg-white/5 border border-white/10 rounded-2xl p-6 md:p-8\">\n                    <div className=\"flex items-center gap-3 mb-6\">\n                      <div className=\"w-12 h-12 rounded-xl flex items-center justify-center\" style={{ backgroundColor: `${community.config.color}20`, border: `2px solid ${community.config.color}40` }}>\n                        <BookOpen className=\"h-6 w-6\" style={{ color: community.config.color }} />\n                      </div>\n                      <div>\n                        <h2 className=\"text-xl text-white font-bold\">Manifesto</h2>\n                        <span className=\"text-xs text-white/40\">{community.name}</span>\n                      </div>\n                    </div>\n                    <div className=\"border-l-4 pl-6 py-4 rounded-r-lg\" style={{ borderColor: community.config.color, backgroundColor: `${community.config.color}10` }}>\n                      <p className=\"text-white/80 text-lg leading-relaxed italic\">\n                        \"{manifesto}\"\n                      </p>\n                    </div>\n                    {(isMilaActive || effectiveOwnerId) && ownerData && (\n                      <div className=\"flex items-center gap-3 mt-6 pt-4 border-t border-white/10\">\n                        <UserAvatar name={ownerData.name} photoUrl={ownerData.photo} size=\"sm\" />\n                        <p className=\"text-xs text-white/40\">— Escrito por {ownerData.name}, criadora do NeuroConexão Atípica</p>\n                      </div>\n                    )}\n                  </div>\n                )}\n\n                {/* ════════════════════════════════════════\n                    TAB: LIVES\n                ════════════════════════════════════════ */}\n                {activeTab === \"lives\" && (\n                  <div className=\"space-y-4\">\n                    <div className=\"bg-white/5 border border-white/10 rounded-2xl p-6\">\n                      <div className=\"flex items-center justify-between mb-4\">\n                        <h2 className=\"text-lg text-white font-bold flex items-center gap-2\">\n                          <Radio className=\"h-5 w-5 text-[#C8102E]\" /> Lives\n                        </h2>\n                        <button onClick={() => setActiveModal(\"live_application\")} className=\"flex items-center gap-2 px-4 py-2 bg-[#C8102E] text-white rounded-xl text-xs font-bold hover:bg-[#C8102E]/80 transition-colors\">\n                          <Mic className=\"h-4 w-4\" /> Quero fazer uma Live\n                        </button>\n                      </div>\n\n                      {eventsLoading ? (\n                        <div className=\"text-center py-8\">\n                          <Loader2 className=\"h-8 w-8 animate-spin mx-auto text-[#C8102E] mb-3\" />\n                          <p className=\"text-sm text-white/40\">Carregando lives...</p>\n                        </div>\n                      ) : lives.length === 0 ? (\n                        <div className=\"text-center py-8\">\n                          <Radio className=\"h-10 w-10 text-white/20 mx-auto mb-3\" />\n                          <p className=\"text-sm text-white/50\">Nenhuma live agendada ainda.</p>\n                          <p className=\"text-xs text-white/30 mt-1\">Tem algo pra compartilhar? Inscreva-se para fazer uma!</p>\n                        </div>\n                      ) : (\n                        <div className=\"space-y-3\">\n                          {lives.map((event) => (\n                            <EventCard key={event.id} event={event} onToggle={handleToggleEventInterest} user={user} />\n                          ))}\n                        </div>\n                      )}\n                    </div>\n\n                    {/* ═══ SUGERIR TEMA PARA LIVE — DESTAQUE ═══ */}\n                    <motion.div\n                      initial={{ opacity: 0, y: 20 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      transition={{ delay: 0.15 }}\n                      className=\"bg-gradient-to-br from-[#C8102E]/15 to-[#C8102E]/5 border border-[#C8102E]/30 rounded-2xl p-5\"\n                    >\n                      <div className=\"flex items-center gap-3 mb-2\">\n                        <div className=\"w-9 h-9 rounded-lg bg-[#C8102E] flex items-center justify-center flex-shrink-0\">\n                          <Lightbulb className=\"h-4 w-4 text-white\" />\n                        </div>\n                        <h3 className=\"text-sm text-white font-bold\">Sugira um tema para live</h3>\n                      </div>\n                      <p className=\"text-xs text-white/60 mb-3 leading-relaxed\">\n                        Que assunto você gostaria de ver numa live desta comunidade? Sua sugestão vai direto pra equipe e influencia a agenda.\n                      </p>\n                      <button\n                        onClick={() => hasMemberAccess ? setActiveModal(\"tema_live\") : alert(\"Faça login e aguarde aprovação para acessar.\")}\n                        className=\"w-full py-2.5 bg-white text-[#C8102E] rounded-xl text-sm transition-all hover:bg-white/90 cursor-pointer font-bold\"\n                      >\n                        Enviar sugestão de tema\n                      </button>\n                    </motion.div>\n                  </div>\n                )}\n\n                {/* ════════════════════════════════════════\n                    TAB: EVENTOS\n                ════════════════════════════════════════ */}\n                {activeTab === \"eventos\" && (\n                  <div className=\"space-y-4\">\n                    <div className=\"bg-white/5 border border-white/10 rounded-2xl p-6\">\n                      <div className=\"flex items-center justify-between mb-4\">\n                        <h2 className=\"text-lg text-white font-bold flex items-center gap-2\">\n                          <Calendar className=\"h-5 w-5 text-[#81D8D0]\" /> Eventos\n                        </h2>\n                        <button onClick={() => setActiveModal(\"evento_sugestao\")} className=\"flex items-center gap-2 px-4 py-2 bg-[#81D8D0] text-black rounded-xl text-xs font-bold hover:bg-[#81D8D0]/90 transition-colors\">\n                          <CalendarPlus className=\"h-4 w-4\" /> Sugerir evento\n                        </button>\n                      </div>\n\n                      {eventsLoading ? (\n                        <div className=\"text-center py-8\">\n                          <Loader2 className=\"h-8 w-8 animate-spin mx-auto text-[#81D8D0] mb-3\" />\n                        </div>\n                      ) : eventos.length === 0 ? (\n                        <div className=\"text-center py-8\">\n                          <Calendar className=\"h-10 w-10 text-white/20 mx-auto mb-3\" />\n                          <p className=\"text-sm text-white/50\">Nenhum evento agendado.</p>\n                          <p className=\"text-xs text-white/30 mt-1\">Sugira um workshop, debate, encontro ou ritual!</p>\n                        </div>\n                      ) : (\n                        <div className=\"space-y-3\">\n                          {eventos.map((event) => (\n                            <EventCard key={event.id} event={event} onToggle={handleToggleEventInterest} user={user} />\n                          ))}\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                )}\n\n                {/* ════════════════════════════════════════\n                    TAB: RITUAIS\n                ════════════════════════════════════════ */}\n                {activeTab === \"rituais\" && (\n                  <div className=\"space-y-5\">\n                    <div className=\"bg-white/5 border border-white/10 rounded-2xl p-6\">\n                      <div className=\"flex items-center justify-between mb-4\">\n                        <h2 className=\"text-lg text-white font-bold\">Rituais Disponíveis</h2>\n                        {community.ritual_enabled && (\n                          <span className=\"text-[10px] text-[#81D8D0] bg-[#81D8D0]/15 px-2 py-0.5 rounded-full border border-[#81D8D0]/20 font-bold\">\n                            Rituais habilitados\n                          </span>\n                        )}\n                      </div>\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                        {RITUAIS.map((ritual) => (\n                          <div key={ritual.nome} className=\"border border-white/10 rounded-xl p-4 hover:border-[#81D8D0]/30 transition-colors bg-white/3\">\n                            <div className=\"flex items-center gap-2 mb-2\">\n                              <span className=\"text-xl\">{ritual.icone}</span>\n                              <h4 className=\"text-white font-semibold\">{ritual.nome}</h4>\n                            </div>\n                            <p className=\"text-xs text-white/50 leading-relaxed\">{ritual.desc}</p>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {/* ════════════════════════════════════════\n                    TAB: CHAT EM GRUPO (Realtime)\n                ════════════════════════════════════════ */}\n                {activeTab === \"chat\" && (\n                  <div className=\"bg-white/5 border border-white/10 rounded-2xl overflow-hidden\">\n                    {/* Chat Header */}\n                    <div className=\"bg-white/5 border-b border-white/10 px-5 py-3 flex items-center justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        <MessageSquare className=\"h-4 w-4 text-[#81D8D0]\" />\n                        <h2 className=\"text-white font-bold text-sm\">Chat da Comunidade</h2>\n                        <span className=\"text-[10px] text-[#81D8D0] bg-[#81D8D0]/15 px-2 py-0.5 rounded-full font-bold\">TEMPO REAL</span>\n                      </div>\n                      <span className=\"text-white/30 text-xs\">{chatMessages.length} mensagens</span>\n                    </div>\n\n                    {!hasMemberAccess ? (\n                      <div className=\"p-8 text-center\">\n                        <Lock className=\"h-10 w-10 text-white/20 mx-auto mb-3\" />\n                        <p className=\"text-white/50 text-sm font-semibold\">Chat disponível apenas para membros aprovados</p>\n                        <p className=\"text-white/30 text-xs mt-1\">Faça login e aguarde aprovação para participar.</p>\n                      </div>\n                    ) : (\n                      <>\n                        {/* Messages area */}\n                        <div className=\"h-[400px] overflow-y-auto p-4 space-y-3\">\n                          {chatLoading ? (\n                            <div className=\"text-center py-8\">\n                              <Loader2 className=\"h-8 w-8 animate-spin mx-auto text-[#81D8D0] mb-3\" />\n                              <p className=\"text-sm text-white/40\">Carregando chat...</p>\n                            </div>\n                          ) : chatMessages.length === 0 ? (\n                            <div className=\"text-center py-12\">\n                              <MessageSquare className=\"h-10 w-10 text-white/10 mx-auto mb-3\" />\n                              <p className=\"text-white/30 text-sm\">Nenhuma mensagem ainda. Comece a conversa!</p>\n                            </div>\n                          ) : (\n                            chatMessages.map((msg) => {\n                              const isMe = msg.author_id === user?.id;\n                              return (\n                                <div key={msg.id} className={`flex items-start gap-2 ${isMe ? \"flex-row-reverse\" : \"\"}`}>\n                                  <UserAvatar\n                                    name={msg.author_data?.display_name || msg.author_data?.name || \"Membro\"}\n                                    photoUrl={msg.author_data?.profile_photo || null}\n                                    size=\"sm\"\n                                    onClick={() => onNavigateToProfile(msg.author_id)}\n                                  />\n                                  <div className={`max-w-[70%] ${isMe ? \"items-end\" : \"items-start\"}`}>\n                                    <div className=\"flex items-center gap-2 mb-0.5\">\n                                      {!isMe && (\n                                        <span className=\"text-[10px] text-white/50 font-semibold\">{msg.author_data?.display_name || msg.author_data?.name}</span>\n                                      )}\n                                      <span className=\"text-[9px] text-white/20\">\n                                        {new Date(msg.created_at).toLocaleTimeString(\"pt-BR\", { hour: \"2-digit\", minute: \"2-digit\" })}\n                                      </span>\n                                    </div>\n                                    <div className={`px-3 py-2 rounded-xl text-sm ${\n                                      isMe\n                                        ? \"bg-[#81D8D0] text-black rounded-br-sm\"\n                                        : \"bg-white/10 text-white rounded-bl-sm\"\n                                    }`}>\n                                      {msg.content}\n                                    </div>\n                                  </div>\n                                </div>\n                              );\n                            })\n                          )}\n                          <div ref={chatEndRef} />\n                        </div>\n\n                        {/* Chat Input */}\n                        <div className=\"border-t border-white/10 p-3 flex items-center gap-2\">\n                          <input\n                            value={chatInput}\n                            onChange={(e) => setChatInput(e.target.value)}\n                            onKeyDown={(e) => e.key === \"Enter\" && !e.shiftKey && handleSendChat()}\n                            placeholder=\"Digite sua mensagem...\"\n                            className=\"flex-1 bg-white/5 border border-white/10 rounded-xl px-4 py-2.5 text-white text-sm placeholder:text-white/30 focus:outline-none focus:border-[#81D8D0]/50\"\n                          />\n                          <button\n                            onClick={handleSendChat}\n                            disabled={!chatInput.trim() || sendingChat}\n                            className=\"p-2.5 bg-[#81D8D0] text-black rounded-xl hover:bg-[#81D8D0]/90 transition-colors disabled:opacity-50\"\n                          >\n                            {sendingChat ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Send className=\"h-4 w-4\" />}\n                          </button>\n                        </div>\n                      </>\n                    )}\n                  </div>\n                )}\n              </motion.div>\n            </AnimatePresence>\n          </div>\n        </div>\n      </div>\n\n      {/* Create Post Modal */}\n      {isRealCommunity && (\n        <CreatePostModal\n          isOpen={isCreatePostOpen}\n          onClose={() => setIsCreatePostOpen(false)}\n          onPostCreated={refreshPosts}\n          defaultCommunityId={community.id}\n        />\n      )}\n\n      {/* ═══ ACTION MODALS ═══ */}\n      {[\"contato\", \"tema_live\", \"evento_sugestao\", \"live_application\", \"denuncia\"].map((tipo) => {\n        const config: Record<string, { title: string; placeholder: string; btnText: string; btnColor: string; successMsg: string; description: string; showTema?: boolean; showHorario?: boolean }> = {\n          contato: {\n            title: \"Falar com a equipe\",\n            placeholder: \"Sua mensagem\",\n            btnText: \"Enviar\",\n            btnColor: \"#81D8D0\",\n            successMsg: \"Mensagem enviada!\",\n            description: \"\",\n          },\n          tema_live: {\n            title: \"Sugerir tema para live\",\n            placeholder: \"Descreva o tema que gostaria de abordar na live\",\n            btnText: \"Enviar sugestão\",\n            btnColor: \"#C8102E\",\n            successMsg: \"Sugestão enviada! Vamos avaliar.\",\n            description: \"Tem uma ideia de tema para uma live? Descreva o formato e o que espera.\",\n            showTema: true,\n            showHorario: true,\n          },\n          evento_sugestao: {\n            title: \"Sugerir evento para a comunidade\",\n            placeholder: \"Descreva sua ideia de evento (workshop, debate, encontro, ritual...)\",\n            btnText: \"Enviar sugestão\",\n            btnColor: \"#FF6B35\",\n            successMsg: \"Sugestão enviada! Vamos avaliar.\",\n            description: \"Tem uma ideia de evento? Descreva o formato, tema e o que espera.\",\n            showTema: true,\n            showHorario: true,\n          },\n          live_application: {\n            title: \"Inscrição para fazer uma Live\",\n            placeholder: \"Sobre o que você quer falar? Qual o formato? (palestra, bate-papo, debate...)\",\n            btnText: \"Enviar inscrição\",\n            btnColor: \"#C8102E\",\n            successMsg: \"Inscrição enviada! Entraremos em contato.\",\n            description: \"Quer compartilhar algo com a comunidade ao vivo? Preencha o formulário abaixo.\",\n            showTema: true,\n            showHorario: true,\n          },\n          denuncia: {\n            title: \"Fazer denúncia\",\n            placeholder: \"Descreva a situação com o máximo de detalhes possível...\",\n            btnText: \"Enviar denúncia\",\n            btnColor: \"#C8102E\",\n            successMsg: \"Denúncia recebida. Será tratada com sigilo.\",\n            description: \"Relatos são tratados com seriedade e sigilo absoluto.\",\n          },\n        };\n        const c = config[tipo];\n        if (!c) return null;\n        return (\n          <AnimatePresence key={tipo}>\n            {activeModal === tipo && (\n              <motion.div\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                exit={{ opacity: 0 }}\n                className=\"fixed inset-0 z-50 flex items-center justify-center p-4\"\n                onClick={() => setActiveModal(null)}\n              >\n                <div className=\"absolute inset-0 bg-black/70 backdrop-blur-sm\" />\n                <motion.div\n                  initial={{ scale: 0.95, opacity: 0 }}\n                  animate={{ scale: 1, opacity: 1 }}\n                  exit={{ scale: 0.95, opacity: 0 }}\n                  onClick={(e) => e.stopPropagation()}\n                  className=\"relative bg-[#1a1a2e] rounded-2xl p-6 max-w-md w-full shadow-2xl border border-white/10\"\n                >\n                  <button onClick={() => setActiveModal(null)} className=\"absolute top-3 right-3 p-1 hover:bg-white/10 rounded-lg\">\n                    <X className=\"h-5 w-5 text-white/40\" />\n                  </button>\n                  <h3 className=\"text-lg text-white font-bold mb-4\">{c.title}</h3>\n                  {formSent[tipo] ? (\n                    <div className=\"text-center py-4\">\n                      <Check className=\"h-10 w-10 mx-auto mb-3\" style={{ color: c.btnColor }} />\n                      <p className=\"text-white font-semibold\">{c.successMsg}</p>\n                    </div>\n                  ) : (\n                    <div className=\"space-y-3\">\n                      {c.description && <p className=\"text-sm text-white/50\">{c.description}</p>}\n                      <input type=\"text\" placeholder=\"Seu nome\" value={formData.nome} onChange={(e) => setFormData(prev => ({ ...prev, nome: e.target.value }))} className={inputClass} />\n                      <input type=\"email\" placeholder=\"Seu email\" value={formData.email} onChange={(e) => setFormData(prev => ({ ...prev, email: e.target.value }))} className={inputClass} />\n                      {c.showTema && (\n                        <input type=\"text\" placeholder=\"Tema / Assunto\" value={formData.tema} onChange={(e) => setFormData(prev => ({ ...prev, tema: e.target.value }))} className={inputClass} />\n                      )}\n                      {c.showHorario && (\n                        <input type=\"text\" placeholder=\"Horário sugerido (ex: Sábado 20h)\" value={formData.horario} onChange={(e) => setFormData(prev => ({ ...prev, horario: e.target.value }))} className={inputClass} />\n                      )}\n                      <textarea placeholder={c.placeholder} value={formData.mensagem} onChange={(e) => setFormData(prev => ({ ...prev, mensagem: e.target.value }))} rows={4} className={`${inputClass} resize-none`} />\n                      <button\n                        onClick={() => handleFormSubmit(tipo)}\n                        disabled={formLoading}\n                        className=\"w-full py-2.5 text-white rounded-xl text-sm font-bold hover:opacity-90 transition-colors disabled:opacity-50\"\n                        style={{ backgroundColor: c.btnColor }}\n                      >\n                        <span className=\"flex items-center justify-center gap-2\">\n                          {formLoading ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Send className=\"h-4 w-4\" />}\n                          {formLoading ? \"Enviando...\" : c.btnText}\n                        </span>\n                      </button>\n                    </div>\n                  )}\n                </motion.div>\n              </motion.div>\n            )}\n          </AnimatePresence>\n        );\n      })}\n    </div>\n    </MembershipGate>\n  );\n}\n\n// ═══ SUBCOMPONENTS ═══\n\nfunction EmptyMural({ community, IconComponent, canPost, onCreatePost }: { community: CommunityWithMeta; IconComponent: any; canPost: boolean; onCreatePost: () => void }) {\n  const isRealCommunity = !community.id.startsWith(\"pending-\") && !community.id.startsWith(\"local-\");\n  return (\n    <div className=\"bg-white/5 border border-white/10 rounded-2xl p-8 text-center\">\n      <div className=\"w-16 h-16 rounded-xl flex items-center justify-center mx-auto mb-4\" style={{ backgroundColor: `${community.config.color}20` }}>\n        <IconComponent className=\"h-8 w-8\" style={{ color: community.config.color }} />\n      </div>\n      <h3 className=\"text-xl text-white font-semibold mb-2\">\n        {isRealCommunity ? \"O mural está esperando por você\" : \"Comunidade em preparação\"}\n      </h3>\n      <p className=\"text-sm text-white/50 mb-4 max-w-md mx-auto\">\n        {isRealCommunity ? \"Nenhum post ainda. Seja a primeira pessoa a falar.\" : \"Em breve esta comunidade será ativada.\"}\n      </p>\n      {community.config.starters && community.config.starters.length > 0 && (\n        <div className=\"bg-white/5 border border-white/10 rounded-xl p-4 mt-4 text-left max-w-lg mx-auto\">\n          <div className=\"flex items-center gap-2 mb-3\">\n            <Sparkles className=\"h-4 w-4\" style={{ color: community.config.color }} />\n            <span className=\"text-sm text-white font-semibold\">Sugestões para começar</span>\n          </div>\n          <div className=\"space-y-2\">\n            {community.config.starters.map((s, idx) => (\n              <button key={idx} onClick={canPost ? onCreatePost : undefined} className=\"block w-full text-left p-3 rounded-lg bg-white/5 border border-white/10 hover:border-white/20 transition-colors\">\n                <span className=\"text-sm text-white/60\">{s}</span>\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n      {isRealCommunity && canPost && (\n        <button onClick={onCreatePost} className=\"mt-4 inline-flex items-center gap-2 px-6 py-3 rounded-xl text-white transition-all hover:scale-[1.02] font-semibold\" style={{ backgroundColor: community.config.color }}>\n          <PlusCircle className=\"h-5 w-5\" /> Iniciar conversa\n        </button>\n      )}\n    </div>\n  );\n}\n\nfunction EventCard({ event, onToggle, user }: { event: EventWithMeta; onToggle: (e: EventWithMeta) => void; user: any }) {\n  const dt = formatEventDate(event.starts_at);\n  const isLive = event.event_type === \"live\";\n  const isLiveNow = event.status === \"live\" || event.status === \"live_now\";\n\n  return (\n    <div className={`border rounded-xl p-4 ${isLiveNow ? \"border-[#C8102E]/50 bg-[#C8102E]/5\" : isLive ? \"border-[#C8102E]/20\" : \"border-white/10\"}`}>\n      <div className=\"flex items-center gap-3\">\n        <div className={`w-14 h-14 rounded-xl flex flex-col items-center justify-center flex-shrink-0 ${isLiveNow ? \"bg-[#C8102E]\" : isLive ? \"bg-[#C8102E]/10\" : \"bg-white/5\"}`}>\n          <span className={`text-lg font-bold ${isLiveNow ? \"text-white\" : isLive ? \"text-[#C8102E]\" : \"text-white\"}`}>{dt.dia}</span>\n          <span className={`text-[10px] uppercase font-semibold ${isLiveNow ? \"text-white/80\" : isLive ? \"text-[#C8102E]/60\" : \"text-white/40\"}`}>{dt.mesLabel}</span>\n        </div>\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center gap-2 mb-1 flex-wrap\">\n            <span className={`text-[10px] uppercase tracking-wider px-2 py-0.5 rounded-full font-bold ${\n              isLive ? \"bg-[#C8102E] text-white\" : event.event_type === \"workshop\" ? \"bg-[#81D8D0] text-black\" : \"bg-purple-500 text-white\"\n            }`}>\n              {event.event_type === \"ritual\" ? \"RITUAL\" : event.event_type === \"workshop\" ? \"WORKSHOP\" : \"LIVE\"}\n            </span>\n            {isLiveNow && <span className=\"text-[10px] uppercase px-2 py-0.5 bg-[#C8102E] text-white rounded-full animate-pulse font-bold\">AO VIVO</span>}\n          </div>\n          <h4 className=\"text-white font-semibold\">{event.title}</h4>\n          <div className=\"flex items-center gap-2 text-xs text-white/40 mt-0.5\">\n            <span>{dt.hora} • Host: {event.host_name}</span>\n            {event.participant_count > 0 && (\n              <span className=\"flex items-center gap-0.5 text-[#81D8D0]\">\n                <Users className=\"h-3 w-3\" /> {event.participant_count}\n              </span>\n            )}\n          </div>\n        </div>\n        <div className=\"flex flex-col gap-1.5 flex-shrink-0\">\n          {event.location_url ? (\n            <a href={event.location_url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"inline-flex items-center gap-1 px-3 py-1.5 bg-[#C8102E] text-white rounded-lg text-xs font-semibold\">\n              <ExternalLink className=\"h-3 w-3\" /> Acessar\n            </a>\n          ) : (\n            <span className=\"text-[10px] text-white/30 px-2 py-1 bg-white/5 rounded-lg text-center\">Link em breve</span>\n          )}\n          {user && (\n            <button\n              onClick={() => onToggle(event)}\n              className={`inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-xs border transition-colors font-semibold ${\n                event.is_participating\n                  ? \"bg-[#81D8D0] text-black border-[#81D8D0]\"\n                  : \"bg-white/5 text-white/60 border-white/10 hover:border-white/30\"\n              }`}\n            >\n              {event.is_participating ? <><Check className=\"h-3 w-3\" /> Interesse!</> : <><Heart className=\"h-3 w-3\" /> Participar</>}\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}"
}