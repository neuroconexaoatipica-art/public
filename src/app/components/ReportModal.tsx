{
  "lote": 4,
  "status": "pending",
  "file_path": "src/app/components/ReportModal.tsx",
  "created_at": "2026-02-27T05:36:23.576Z",
  "file_content": "import { useState } from \"react\";\nimport { motion, AnimatePresence } from \"motion/react\";\nimport { X, AlertTriangle, ShieldAlert, Send, Check } from \"lucide-react\";\nimport { useReports, REPORT_TYPE_LABELS } from \"../../lib\";\nimport type { ReportType } from \"../../lib\";\n\ninterface ReportModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  contentId?: string;\n  contentType?: \"post\" | \"comment\" | \"message\" | \"community_message\" | \"profile\" | \"testimonial\";\n  reportedUserId?: string;\n}\n\nconst REPORT_CATEGORIES: { type: ReportType; label: string; icon: string; severity: \"low\" | \"medium\" | \"high\" | \"critical\" }[] = [\n  { type: \"child_safety\", label: \"Explora√ß√£o infantil ou presen√ßa de menor\", icon: \"üö®\", severity: \"critical\" },\n  { type: \"sexual_content\", label: \"Conte√∫do sexual n√£o consensual\", icon: \"‚ö†Ô∏è\", severity: \"high\" },\n  { type: \"violence\", label: \"Viol√™ncia ou amea√ßa\", icon: \"üî¥\", severity: \"high\" },\n  { type: \"self_harm\", label: \"Autoles√£o ou suic√≠dio\", icon: \"üíî\", severity: \"high\" },\n  { type: \"harassment\", label: \"Ass√©dio ou persegui√ß√£o\", icon: \"üö´\", severity: \"medium\" },\n  { type: \"hate_speech\", label: \"Discurso de √≥dio\", icon: \"‚ùå\", severity: \"medium\" },\n  { type: \"impersonation\", label: \"Falsa identidade\", icon: \"üé≠\", severity: \"medium\" },\n  { type: \"privacy_violation\", label: \"Viola√ß√£o de privacidade\", icon: \"üîí\", severity: \"medium\" },\n  { type: \"inappropriate_content\", label: \"Conte√∫do inadequado\", icon: \"üìõ\", severity: \"low\" },\n  { type: \"spam\", label: \"Spam ou propaganda\", icon: \"üìß\", severity: \"low\" },\n  { type: \"other\", label: \"Outro motivo\", icon: \"üìù\", severity: \"low\" },\n];\n\nexport function ReportModal({ isOpen, onClose, contentId, contentType, reportedUserId }: ReportModalProps) {\n  const [selectedType, setSelectedType] = useState<ReportType | null>(null);\n  const [description, setDescription] = useState(\"\");\n  const [submitted, setSubmitted] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const { submitReport } = useReports();\n\n  const handleSubmit = async () => {\n    if (!selectedType) return;\n    setIsSubmitting(true);\n    try {\n      const category = REPORT_CATEGORIES.find(c => c.type === selectedType);\n      await submitReport({\n        reportedUserId: reportedUserId || undefined,\n        contentId: contentId || undefined,\n        contentType: contentType || undefined,\n        reportType: selectedType,\n        severity: category?.severity || \"medium\",\n        description: description.trim() || undefined,\n      });\n      setSubmitted(true);\n    } catch (err) {\n      console.error(\"Erro ao enviar den√∫ncia:\", err);\n    }\n    setIsSubmitting(false);\n  };\n\n  const handleClose = () => {\n    setSelectedType(null);\n    setDescription(\"\");\n    setSubmitted(false);\n    onClose();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <AnimatePresence>\n      <motion.div\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n        className=\"fixed inset-0 z-[100] flex items-center justify-center bg-black/70 backdrop-blur-sm p-4\"\n        onClick={handleClose}\n      >\n        <motion.div\n          initial={{ scale: 0.95, opacity: 0 }}\n          animate={{ scale: 1, opacity: 1 }}\n          exit={{ scale: 0.95, opacity: 0 }}\n          onClick={(e) => e.stopPropagation()}\n          className=\"w-full max-w-lg bg-[#1A1A1A] border border-white/10 rounded-2xl overflow-hidden\"\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between px-6 py-4 border-b border-white/10\">\n            <div className=\"flex items-center gap-3\">\n              <ShieldAlert className=\"h-5 w-5 text-[#C8102E]\" />\n              <h2 className=\"text-white text-lg\" style={{ fontWeight: 700 }}>Denunciar</h2>\n            </div>\n            <button onClick={handleClose} className=\"text-white/40 hover:text-white/80 transition-colors\">\n              <X className=\"h-5 w-5\" />\n            </button>\n          </div>\n\n          {submitted ? (\n            /* Confirma√ß√£o */\n            <div className=\"px-6 py-12 text-center\">\n              <motion.div\n                initial={{ scale: 0 }}\n                animate={{ scale: 1 }}\n                transition={{ type: \"spring\", damping: 12 }}\n                className=\"w-16 h-16 mx-auto mb-6 rounded-full bg-[#0A8F85]/20 flex items-center justify-center\"\n              >\n                <Check className=\"h-8 w-8 text-[#0A8F85]\" />\n              </motion.div>\n              <h3 className=\"text-white text-xl mb-2\" style={{ fontWeight: 700 }}>Den√∫ncia enviada</h3>\n              <p className=\"text-white/60 text-sm mb-6 max-w-sm mx-auto\">\n                {selectedType === \"child_safety\"\n                  ? \"Esta den√∫ncia foi marcada como CR√çTICA e ser√° analisada imediatamente pela administra√ß√£o.\"\n                  : \"Sua den√∫ncia ser√° analisada pela equipe de modera√ß√£o. Obrigada por ajudar a manter este espa√ßo seguro.\"}\n              </p>\n              <button\n                onClick={handleClose}\n                className=\"px-8 py-3 bg-white/10 text-white rounded-xl text-sm hover:bg-white/15 transition-colors\"\n                style={{ fontWeight: 600 }}\n              >\n                Fechar\n              </button>\n            </div>\n          ) : (\n            /* Formul√°rio */\n            <div className=\"px-6 py-5 max-h-[70vh] overflow-y-auto\">\n              {/* Alerta child safety */}\n              <div className=\"flex items-start gap-3 bg-[#C8102E]/10 border border-[#C8102E]/25 rounded-xl p-4 mb-5\">\n                <AlertTriangle className=\"h-5 w-5 text-[#C8102E] flex-shrink-0 mt-0.5\" />\n                <p className=\"text-sm text-white/80\">\n                  Den√∫ncias de explora√ß√£o infantil s√£o tratadas com prioridade m√°xima e encaminhadas imediatamente.\n                </p>\n              </div>\n\n              {/* Tipos */}\n              <p className=\"text-white/50 text-xs uppercase tracking-wider mb-3\" style={{ fontWeight: 600 }}>Motivo da den√∫ncia</p>\n              <div className=\"space-y-2 mb-5\">\n                {REPORT_CATEGORIES.map((cat) => (\n                  <button\n                    key={cat.type}\n                    onClick={() => setSelectedType(cat.type)}\n                    className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left transition-all text-sm ${\n                      selectedType === cat.type\n                        ? cat.type === \"child_safety\"\n                          ? \"bg-[#C8102E]/20 border-2 border-[#C8102E]/50 text-white\"\n                          : \"bg-white/10 border-2 border-[#81D8D0]/50 text-white\"\n                        : \"bg-white/3 border border-white/8 text-white/70 hover:bg-white/5 hover:border-white/15\"\n                    }`}\n                  >\n                    <span className=\"text-base\">{cat.icon}</span>\n                    <span>{cat.label}</span>\n                    {cat.severity === \"critical\" && (\n                      <span className=\"ml-auto text-[10px] px-2 py-0.5 bg-[#C8102E] text-white rounded-full\" style={{ fontWeight: 700 }}>\n                        URGENTE\n                      </span>\n                    )}\n                  </button>\n                ))}\n              </div>\n\n              {/* Descri√ß√£o */}\n              {selectedType && (\n                <motion.div initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }}>\n                  <p className=\"text-white/50 text-xs uppercase tracking-wider mb-2\" style={{ fontWeight: 600 }}>\n                    Detalhes (opcional)\n                  </p>\n                  <textarea\n                    value={description}\n                    onChange={(e) => setDescription(e.target.value)}\n                    placeholder=\"Descreva o que aconteceu...\"\n                    maxLength={2000}\n                    rows={4}\n                    className=\"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white text-sm placeholder:text-white/30 focus:border-white/25 focus:outline-none resize-none\"\n                  />\n                  <p className=\"text-white/30 text-xs text-right mt-1\">{description.length}/2000</p>\n                </motion.div>\n              )}\n\n              {/* Submit */}\n              <div className=\"flex gap-3 mt-5 pt-4 border-t border-white/8\">\n                <button\n                  onClick={handleClose}\n                  className=\"flex-1 px-4 py-3 bg-white/5 text-white/60 rounded-xl text-sm hover:bg-white/10 transition-colors\"\n                  style={{ fontWeight: 600 }}\n                >\n                  Cancelar\n                </button>\n                <motion.button\n                  onClick={handleSubmit}\n                  disabled={!selectedType || isSubmitting}\n                  whileHover={{ scale: 1.02 }}\n                  whileTap={{ scale: 0.98 }}\n                  className={`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl text-sm text-white disabled:opacity-40 transition-all ${\n                    selectedType === \"child_safety\" ? \"bg-[#C8102E]\" : \"bg-[#0A8F85]\"\n                  }`}\n                  style={{ fontWeight: 700 }}\n                >\n                  <Send className=\"h-4 w-4\" />\n                  {isSubmitting ? \"Enviando...\" : \"Enviar den√∫ncia\"}\n                </motion.button>\n              </div>\n            </div>\n          )}\n        </motion.div>\n      </motion.div>\n    </AnimatePresence>\n  );\n}\n"
}