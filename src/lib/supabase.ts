{
  "lote": 0,
  "status": "pending",
  "file_path": "src/lib/supabase.ts",
  "created_at": "2026-02-27T05:36:02.733Z",
  "file_content": "import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = import.meta.env.VITE_SUPABASE_URL || 'https://ieieohtnaymykxiqnmlc.supabase.co';\nconst supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImllaWVvaHRuYXlteWt4aXFubWxjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA0OTQ1NzMsImV4cCI6MjA4NjA3MDU3M30.32LjQe1dQLGAfbyfK8KkjNlXOGkZGaWEgI20y3gl3Hc';\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\n  auth: {\n    persistSession: true,\n    autoRefreshToken: true,\n    detectSessionInUrl: false,    // SPA sem OAuth redirect — evita parse desnecessário\n    storage: window.localStorage,  // Explícito: evita fallback para memória\n  },\n  global: {\n    headers: {\n      'x-client-info': 'neuroconexao-atipica/1.0',\n    },\n    // Timeout global de 45s — cobre cold start do plano gratuito Supabase\n    // Free tier pode levar 15-30s pra acordar após inatividade\n    fetch: (url, options = {}) => {\n      const controller = new AbortController();\n      const timeout = setTimeout(() => controller.abort(), 45000);\n\n      // Se já tem signal externo, combinar\n      if (options.signal) {\n        options.signal.addEventListener('abort', () => controller.abort());\n      }\n\n      return fetch(url, { ...options, signal: controller.signal }).finally(() => {\n        clearTimeout(timeout);\n      });\n    },\n  },\n  db: {\n    schema: 'public',\n  },\n});\n\n// Constantes globais de timeout — fonte única de verdade\nexport const TIMEOUTS = {\n  /** Queries de leitura (SELECT) */\n  QUERY: 30_000,\n  /** Operações de escrita (INSERT, UPDATE, DELETE) */\n  MUTATION: 45_000,\n  /** Carregamento de perfil na inicialização */\n  PROFILE: 12_000,\n  /** Upload de arquivos */\n  UPLOAD: 30_000,\n  /** Safety net — libera UI mesmo se tudo travar */\n  SAFETY_NET: 10_000,\n} as const;\n\n// Chave do localStorage onde o Supabase armazena a sessão\n// Formato: sb-<project-ref>-auth-token\nexport const SUPABASE_STORAGE_KEY = 'sb-ieieohtnaymykxiqnmlc-auth-token';\n\n// Tipos TypeScript para o banco de dados\n// V8: 6 roles — registered_unfinished eliminado\nexport type UserRole = 'visitor' | 'registered_unfinished' | 'member_free_legacy' | 'member_paid' | 'founder_paid' | 'moderator' | 'super_admin' | 'banned';\n\nexport interface User {\n  id: string;\n  name: string;\n  bio: string | null;\n  profile_photo: string | null;\n  role: UserRole;\n  access_released: boolean;\n  onboarding_done: boolean;\n  whatsapp: string[] | null;\n  beta_lifetime: string[] | null;\n  allow_whatsapp: boolean;\n  allow_email: boolean;\n  terms_version: string;\n  terms_accepted_at: string;\n  updated_at: string;\n  created_at: string;\n  // V8: novos campos\n  about_text: string;\n  what_crosses_me: string;\n  interests: string[];\n  participation_score: number;\n  is_public_profile: boolean;\n  leadership_onboarding_done: boolean;\n  is_beta_lifetime_flag: boolean;\n  age_verified: boolean;\n  subscription_status: 'none' | 'active' | 'cancelled' | 'past_due';\n  subscription_expires_at: string | null;\n  // V1.1: Identidade controlada + profundidade\n  display_name: string;\n  legal_name: string | null;\n  use_real_name: boolean;\n  is_anonymous_mode: boolean;\n  deep_statement: string | null;\n  deep_statement_public: boolean;\n  last_active_at: string | null;\n  // V1.2: Galeria de fotos\n  gallery_photos: string[];\n  // V1.3: Identidade & Acolhimento + Comunicação\n  pronouns: string | null;\n  neurodivergences: string[];\n  neurodivergences_public: boolean;\n  calming_statement: string | null;\n  calming_statement_public: boolean;\n  communication_style: string[];\n  social_instagram: string | null;\n  social_link: string | null;\n}\n\nexport interface Community {\n  id: string;\n  name: string;\n  description: string;\n  is_public: boolean;\n  creator: string | null;\n  created_at: string;\n  // V8: novos campos\n  owner_id: string | null;\n  manifesto_text: string;\n  needs_moderator: boolean;\n  ritual_enabled: boolean;\n  is_featured: boolean;\n  max_members: number;\n  requires_approval: boolean;\n}\n\nexport interface Post {\n  id: string;\n  content: string;\n  author: string;\n  community: string | null;\n  is_public: boolean;\n  is_pinned: boolean;\n  image_url: string | null;\n  created_at: string;\n}\n\nexport interface LiveInterest {\n  id: string;\n  user_id: string;\n  community_id: string;\n  message: string | null;\n  created_at: string;\n}\n\nexport interface Comment {\n  id: string;\n  post_id: string;\n  author: string;\n  content: string;\n  created_at: string;\n}\n\n// V8 Fase 2: Eventos + Rituais\nexport type EventType = 'live' | 'workshop' | 'ritual' | 'encontro' | 'debate' | 'oficina' | 'outro';\nexport type RitualType = 'roda_de_escuta' | 'checkin_coletivo' | 'sessao_de_foco' | 'desabafo_estruturado' | 'ritual_de_acolhimento' | 'debate_guiado' | 'reflexao_silenciosa';\nexport type EventStatus = 'draft' | 'published' | 'live' | 'completed' | 'cancelled';\nexport type LocationType = 'online' | 'presencial' | 'hibrido';\nexport type ParticipantStatus = 'confirmed' | 'interested' | 'cancelled';\n\nexport interface Event {\n  id: string;\n  community_id: string | null;\n  host_id: string | null;\n  title: string;\n  description: string;\n  event_type: EventType;\n  ritual_type: RitualType | null;\n  starts_at: string;\n  ends_at: string | null;\n  max_participants: number | null;\n  status: EventStatus;\n  location_type: LocationType;\n  location_url: string;\n  location_address: string;\n  is_recurring: boolean;\n  recurrence_rule: string | null;\n  cover_image_url: string | null;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface EventParticipant {\n  id: string;\n  event_id: string;\n  user_id: string;\n  status: ParticipantStatus;\n  joined_at: string;\n}"
}